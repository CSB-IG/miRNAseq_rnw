
library(igraph)

# sacar dpi a p-value 1
 
sanos <- read.table("~/TCGA_miRNA_BC/miRNAs_resultados/subredes/sanos_p1_full_norm_adjmtx.txt")
enfermos <- read.table("~/TCGA_miRNA_BC/miRNAs_resultados/subredes/enfermos_p1_full_norm_adjmtx.txt")

sanos <- data.matrix(sanos)
enfermos <- data.matrix(enfermos)

colnames(sanos) <- rownames(sanos)
colnames(enfermos) <- rownames(enfermos)

dim(sanos)
dim(enfermos)

isSymmetric(sanos)
isSymmetric(enfermos)

max(sanos)
max(enfermos)

library(minet)
sanos_dpi <- aracne(mim = sanos, eps = 0.1)
enfermos_dpi <- aracne(mim = enfermos, eps = 0.1)

write.table(sanos_dpi, file = "sanos_p1_full_adjmtx_dpi.txt", sep = "\t", col.names= NA, row.names= T, quote = F)

sg <- graph.adjacency(adjmatrix= sanos_dpi, mode='undirected', diag=F, weighted=T)
sifgs <- get.data.frame(sg)
write.table(sifgs, file = "sanos_p1_full_sif_dpi.txt", sep = "\t", col.names= T, row.names= F, quote = F )

write.table(enfermos_dpi, file = "enfermos_p1_full_adjmtx_dpi.txt", sep = "\t", col.names= NA, row.names= T, quote = F)

eg <- graph.adjacency(adjmatrix= enfermos_dpi, mode='undirected', diag=F, weighted=T)
sifge <- get.data.frame(eg)
write.table(sifge, file = "enfermos_p1_sif_full_dpi.txt", sep = "\t", col.names= T, row.names= F, quote = F )

max(sanos_dpi)
max(enfermos_dpi)

isSymmetric(sanos_dpi)
isSymmetric(enfermos_dpi)

# calcular p value y corte

mir <- colnames(enfermos)[grepl("hsa*", colnames(enfermos))]
head(mir)
length(mir)

genes <- setdiff(colnames(enfermos), mir)
head(genes)
length(genes)

sanos_q <- sanos[upper.tri(sanos, diag=FALSE)]
quantile(sanos_q)

> quantile(sanos_q)
        0%        25%        50%        75%       100% 
0.00000000 0.05664203 0.09509998 0.17335552 1.00000000 

mir_gen_sanos <- sanos
mir_gen_sanos[genes, genes] <- NA
gen_gen_sanos <- sanos[genes, genes]
isSymmetric(mir_gen_sanos)
isSymmetric(gen_gen_sanos)
dim(sanos)
dim(mir_gen_sanos)
dim(gen_gen_sanos)
identical(sum(sanos != 0), (sum(mir_gen_sanos != 0, na.rm=T))+sum(gen_gen_sanos != 0))

mirnas_sanos_q <- mir_gen_sanos[upper.tri(mir_gen_sanos, diag=FALSE)]
genes_sanos_q <- gen_gen_sanos[upper.tri(gen_gen_sanos, diag=FALSE)]

quantile(mirnas_sanos_q, na.rm=T)
quantile(genes_sanos_q)

> quantile(mirnas_sanos_q, na.rm=T)
        0%        25%        50%        75%       100% 
0.00000000 0.04012404 0.05825107 0.08817299 1.00000000 
> quantile(genes_sanos_q)
        0%        25%        50%        75%       100% 
0.00000000 0.05922119 0.10011482 0.18103985 0.96790993 

# filtro 

quantile(mirnas_sanos_q, probs=seq(0.995, 1, 0.00001), na.rm=T)

> quantile(mirnas_sanos_q, probs=seq(0.995, 1, 0.00001), na.rm=T)
 > head(a, n=200)
  99.500%   99.501%   99.502%   99.503%   99.504%   99.505%   99.506%   99.507% 
0.3653001 0.3654515 0.3655935 0.3657027 0.3658374 0.3659744 0.3661279 0.3662878 
  99.508%   99.509%   99.510%   99.511%   99.512%   99.513%   99.514%   99.515% 
0.3664347 0.3665650 0.3667265 0.3668856 0.3670302 0.3671708 0.3673294 0.3674610 
  99.516%   99.517%   99.518%   99.519%   99.520%   99.521%   99.522%   99.523% 
0.3676042 0.3677417 0.3678913 0.3680305 0.3681918 0.3683673 0.3685269 0.3686678 
  99.524%   99.525%   99.526%   99.527%   99.528%   99.529%   99.530%   99.531% 
0.3688203 0.3689665 0.3690833 0.3692267 0.3693592 0.3694946 0.3696740 0.3698029 
  99.532%   99.533%   99.534%   99.535%   99.536%   99.537%   99.538%   99.539% 
0.3699567 0.3701201 0.3702654 0.3703803 0.3705175 0.3706370 0.3707923 0.3709425 
  99.540%   99.541%   99.542%   99.543%   99.544%   99.545%   99.546%   99.547% 
0.3710937 0.3712354 0.3713696 0.3715128 0.3716737 0.3718558 0.3720056 0.3721396 
  99.548%   99.549%   99.550%   99.551%   99.552%   99.553%   99.554%   99.555% 
0.3722885 0.3724643 0.3726352 0.3728066 0.3729501 0.3731083 0.3732896 0.3734679 
  99.556%   99.557%   99.558%   99.559%   99.560%   99.561%   99.562%   99.563% 
0.3736146 0.3738031 0.3739534 0.3741277 0.3742963 0.3744792 0.3746387 0.3747839 
  99.564%   99.565%   99.566%   99.567%   99.568%   99.569%   99.570%   99.571% 
0.3749767 0.3751349 0.3753073 0.3754694 0.3756132 0.3757614 0.3759104 0.3760754 
  99.572%   99.573%   99.574%   99.575%   99.576%   99.577%   99.578%   99.579% 
0.3762346 0.3763962 0.3765645 0.3767302 0.3769068 0.3770893 0.3772736 0.3774260 
  99.580%   99.581%   99.582%   99.583%   99.584%   99.585%   99.586%   99.587% 
0.3775996 0.3777397 0.3779137 0.3781164 0.3782847 0.3784444 0.3785925 0.3787651 
  99.588%   99.589%   99.590%   99.591%   99.592%   99.593%   99.594%   99.595% 
0.3789400 0.3791031 0.3792792 0.3794378 0.3796007 0.3797707 0.3799498 0.3801488 
  99.596%   99.597%   99.598%   99.599%   99.600%   99.601%   99.602%   99.603% 
0.3803426 0.3805249 0.3807012 0.3808612 0.3810017 0.3811810 0.3813527 0.3815151 
  99.604%   99.605%   99.606%   99.607%   99.608%   99.609%   99.610%   99.611% 
0.3816680 0.3818682 0.3820273 0.3822204 0.3824358 0.3826010 0.3827724 0.3829602 
  99.612%   99.613%   99.614%   99.615%   99.616%   99.617%   99.618%   99.619% 
0.3831487 0.3833032 0.3835030 0.3836978 0.3838484 0.3840455 0.3842238 0.3844237 
  99.620%   99.621%   99.622%   99.623%   99.624%   99.625%   99.626%   99.627% 
0.3846097 0.3847906 0.3850281 0.3851917 0.3853718 0.3855459 0.3857262 0.3858888 
  99.628%   99.629%   99.630%   99.631%   99.632%   99.633%   99.634%   99.635% 
0.3860691 0.3862147 0.3863785 0.3865445 0.3867577 0.3869723 0.3871600 0.3873524 
  99.636%   99.637%   99.638%   99.639%   99.640%   99.641%   99.642%   99.643% 
0.3875486 0.3877266 0.3879118 0.3880949 0.3882862 0.3884669 0.3886597 0.3888738 
  99.644%   99.645%   99.646%   99.647%   99.648%   99.649%   99.650%   99.651% 
0.3891134 0.3893293 0.3895536 0.3897365 0.3899263 0.3901206 0.3903194 0.3905176 
  99.652%   99.653%   99.654%   99.655%   99.656%   99.657%   99.658%   99.659% 
0.3907007 0.3909507 0.3911411 0.3913708 0.3915679 0.3917391 0.3919742 0.3921621 
  99.660%   99.661%   99.662%   99.663%   99.664%   99.665%   99.666%   99.667% 
0.3923941 0.3926024 0.3927808 0.3929700 0.3931930 0.3933864 0.3935706 0.3937835 
  99.668%   99.669%   99.670%   99.671%   99.672%   99.673%   99.674%   99.675% 
0.3939686 0.3941518 0.3943719 0.3945750 0.3947775 0.3949463 0.3951724 0.3953934 
  99.676%   99.677%   99.678%   99.679%   99.680%   99.681%   99.682%   99.683% 
0.3956078 0.3958078 0.3960346 0.3962149 0.3964077 0.3966123 0.3968408 0.3970494 
  99.684%   99.685%   99.686%   99.687%   99.688%   99.689%   99.690%   99.691% 
0.3972518 0.3974717 0.3976770 0.3979068 0.3980968 0.3982834 0.3985185 0.3987178 
  99.692%   99.693%   99.694%   99.695%   99.696%   99.697%   99.698%   99.699% 
0.3989200 0.3991427 0.3993666 0.3996568 0.3999185 0.4001069 0.4002939 0.4005155
  99.700%   99.701%   99.702%   99.703%   99.704%   99.705%   99.706%   99.707% 
0.4007530 0.4009451 0.4011897 0.4014147 0.4016222 0.4018489 0.4020832 0.4022992 
  99.708%   99.709%   99.710%   99.711%   99.712%   99.713%   99.714%   99.715% 
0.4025372 0.4027904 0.4029792 0.4032221 0.4034244 0.4036310 0.4038695 0.4040885 
  99.716%   99.717%   99.718%   99.719%   99.720%   99.721%   99.722%   99.723% 
0.4042690 0.4044924 0.4047573 0.4050150 0.4052715 0.4055739 0.4058432 0.4060804 
  99.724%   99.725%   99.726%   99.727%   99.728%   99.729%   99.730%   99.731% 
0.4063303 0.4065587 0.4068009 0.4070391 0.4072616 0.4075247 0.4077823 0.4080350 
  99.732%   99.733%   99.734%   99.735%   99.736%   99.737%   99.738%   99.739% 
0.4082903 0.4084993 0.4087018 0.4089335 0.4092040 0.4094371 0.4097277 0.4099634 
  99.740%   99.741%   99.742%   99.743%   99.744%   99.745%   99.746%   99.747% 
0.4102144 0.4104915 0.4107373 0.4110331 0.4113177 0.4115354 0.4117886 0.4120707 
  99.748%   99.749%   99.750%   99.751%   99.752%   99.753%   99.754%   99.755% 
0.4123831 0.4126629 0.4129022 0.4131761 0.4134296 0.4137801 0.4140958 0.4143884 
  99.756%   99.757%   99.758%   99.759%   99.760%   99.761%   99.762%   99.763% 
0.4146456 0.4149435 0.4151565 0.4154220 0.4156836 0.4159035 0.4161536 0.4164369 
  99.764%   99.765%   99.766%   99.767%   99.768%   99.769%   99.770%   99.771% 
0.4167150 0.4170245 0.4173210 0.4175714 0.4178760 0.4181808 0.4184522 0.4187001 
  99.772%   99.773%   99.774%   99.775%   99.776%   99.777%   99.778%   99.779% 
0.4189679 0.4193108 0.4196368 0.4199491 0.4202129 0.4205152 0.4207881 0.4210833 
  99.780%   99.781%   99.782%   99.783%   99.784%   99.785%   99.786%   99.787% 
0.4213705 0.4216470 0.4219437 0.4222447 0.4225773 0.4229337 0.4232536 0.4235686 
  99.788%   99.789%   99.790%   99.791%   99.792%   99.793%   99.794%   99.795% 
0.4238888 0.4242740 0.4245575 0.4248761 0.4251682 0.4254516 0.4258289 0.4261283 
  99.796%   99.797%   99.798%   99.799%   99.800%   99.801%   99.802%   99.803% 
0.4263946 0.4266863 0.4269981 0.4273403 0.4276231 0.4279944 0.4283020 0.4286066 
  99.804%   99.805%   99.806%   99.807%   99.808%   99.809%   99.810%   99.811% 
0.4289322 0.4292359 0.4295742 0.4299262 0.4302598 0.4306223 0.4309332 0.4312804 
  99.812%   99.813%   99.814%   99.815%   99.816%   99.817%   99.818%   99.819% 
0.4316197 0.4319709 0.4322775 0.4326110 0.4329739 0.4332572 0.4335851 0.4339147 
  99.820%   99.821%   99.822%   99.823%   99.824%   99.825%   99.826%   99.827% 
0.4342539 0.4346374 0.4349737 0.4353696 0.4356888 0.4361268 0.4364811 0.4368164 
  99.828%   99.829%   99.830%   99.831%   99.832%   99.833%   99.834%   99.835% 
0.4371877 0.4375803 0.4379336 0.4383467 0.4386752 0.4390656 0.4393936 0.4397561 
  99.836%   99.837%   99.838%   99.839%   99.840%   99.841%   99.842%   99.843% 
0.4400969 0.4405379 0.4408975 0.4412061 0.4416252 0.4420060 0.4423543 0.4427334 
  99.844%   99.845%   99.846%   99.847%   99.848%   99.849%   99.850%   99.851% 
0.4431192 0.4434570 0.4438645 0.4443526 0.4447475 0.4451141 0.4455096 0.4459613 
  99.852%   99.853%   99.854%   99.855%   99.856%   99.857%   99.858%   99.859% 
0.4463808 0.4467158 0.4471212 0.4475164 0.4479482 0.4483174 0.4487992 0.4492340 
  99.860%   99.861%   99.862%   99.863%   99.864%   99.865%   99.866%   99.867% 
0.4496197 0.4500349 0.4504826 0.4509478 0.4513883 0.4517799 0.4523092 0.4527822 
  99.868%   99.869%   99.870%   99.871%   99.872%   99.873%   99.874%   99.875% 
0.4532587 0.4536912 0.4540880 0.4545790 0.4550212 0.4554888 0.4559541 0.4564912 
  99.876%   99.877%   99.878%   99.879%   99.880%   99.881%   99.882%   99.883% 
0.4569113 0.4573781 0.4578473 0.4583017 0.4587922 0.4592941 0.4597432 0.4602289 
  99.884%   99.885%   99.886%   99.887%   99.888%   99.889%   99.890%   99.891% 
0.4607065 0.4612509 0.4617198 0.4622295 0.4627719 0.4632663 0.4637686 0.4643146 
  99.892%   99.893%   99.894%   99.895%   99.896%   99.897%   99.898%   99.899% 
0.4648906 0.4654318 0.4660733 0.4666676 0.4671813 0.4677896 0.4683569 0.4690340 
  99.900%   99.901%   99.902%   99.903%   99.904%   99.905%   99.906%   99.907% 
0.4696092 0.4701871 0.4707559 0.4713044 0.4717950 0.4723858 0.4729122 0.4734623 
  99.908%   99.909%   99.910%   99.911%   99.912%   99.913%   99.914%   99.915% 
0.4740571 0.4746494 0.4752917 0.4760046 0.4766175 0.4772613 0.4778964 0.4785046 
  99.916%   99.917%   99.918%   99.919%   99.920%   99.921%   99.922%   99.923% 
0.4791368 0.4798509 0.4804629 0.4810805 0.4816911 0.4823803 0.4831093 0.4839400 
  99.924%   99.925%   99.926%   99.927%   99.928%   99.929%   99.930%   99.931% 
0.4846163 0.4853836 0.4859925 0.4867293 0.4875688 0.4882897 0.4890305 0.4898163 
  99.932%   99.933%   99.934%   99.935%   99.936%   99.937%   99.938%   99.939% 
0.4905982 0.4913701 0.4920887 0.4928740 0.4935336 0.4942771 0.4950106 0.4958951 
  99.940%   99.941%   99.942%   99.943%   99.944%   99.945%   99.946%   99.947% 
0.4968551 0.4977763 0.4986696 0.4995965 0.5006514 0.5015560 0.5025205 0.5036419 
  99.948%   99.949%   99.950%   99.951%   99.952%   99.953%   99.954%   99.955% 
0.5045070 0.5054981 0.5063344 0.5074329 0.5084221 0.5094113 0.5104730 0.5116079 
  99.956%   99.957%   99.958%   99.959%   99.960%   99.961%   99.962%   99.963% 
0.5127664 0.5140155 0.5152574 0.5163137 0.5174296 0.5188281 0.5201679 0.5214870 
  99.964%   99.965%   99.966%   99.967%   99.968%   99.969%   99.970%   99.971% 
0.5227786 0.5242250 0.5255255 0.5268381 0.5280855 0.5296854 0.5310653 0.5330069 
  99.972%   99.973%   99.974%   99.975%   99.976%   99.977%   99.978%   99.979% 
0.5350045 0.5366868 0.5385374 0.5405913 0.5425438 0.5441694 0.5457003 0.5476489 
  99.980%   99.981%   99.982%   99.983%   99.984%   99.985%   99.986%   99.987% 
0.5498154 0.5519904 0.5541037 0.5567941 0.5595261 0.5620292 0.5644907 0.5676457 
  99.988%   99.989%   99.990%   99.991%   99.992%   99.993%   99.994%   99.995% 
0.5706701 0.5747394 0.5782743 0.5827241 0.5884297 0.5952860 0.6023735 0.6093252 
  99.996%   99.997%   99.998%   99.999%  100.000% 
0.6174015 0.6268605 0.6399064 0.6590856 1.0000000 

mi2p <- function(mi, n){
  alfa <- 1.062
  beta <- -48.7
  gamma <- -0.634
  x <- exp(-((mi*((-beta) + (-gamma)*n)) - alfa))
  return(x)
}


99.741% = 0.4104915
sum(mirnas_sanos_q > 0.4104915, na.rm=TRUE)
[1] 25334

mi2p(0.4104915, 86)
p-value 1.145633e-18

dim(mir_gen_sanos)
mir_gen_sanos[is.na(mir_gen_sanos)] <- 0
mir_gen_sanos[mir_gen_sanos < 0.4104915] <- 0

(sum(mir_gen_sanos != 0))/2
sum(mirnas_sanos_q > 0.4104915, na.rm=TRUE)

# red gen-gen

quantile(genes_sanos_q, probs=seq(0.995, 1, 0.00001))

> quantile(genes_sanos_q, probs=seq(0.995, 1, 0.00001))
  99.500%   99.501%   99.502%   99.503%   99.504%   99.505%   99.506%   99.507% 
0.5533725 0.5535094 0.5536520 0.5537845 0.5539200 0.5540607 0.5542010 0.5543363 
  99.508%   99.509%   99.510%   99.511%   99.512%   99.513%   99.514%   99.515% 
0.5544760 0.5546115 0.5547469 0.5548866 0.5550264 0.5551661 0.5553044 0.5554398 
  99.516%   99.517%   99.518%   99.519%   99.520%   99.521%   99.522%   99.523% 
0.5555853 0.5557265 0.5558691 0.5560074 0.5561457 0.5562927 0.5564353 0.5565837 
  99.524%   99.525%   99.526%   99.527%   99.528%   99.529%   99.530%   99.531% 
0.5567249 0.5568689 0.5570116 0.5571556 0.5572925 0.5574394 0.5575907 0.5577333 
  99.532%   99.533%   99.534%   99.535%   99.536%   99.537%   99.538%   99.539% 
0.5578803 0.5580258 0.5581684 0.5583096 0.5584551 0.5586020 0.5587461 0.5588959 
  99.540%   99.541%   99.542%   99.543%   99.544%   99.545%   99.546%   99.547% 
0.5590385 0.5591811 0.5593353 0.5594837 0.5596349 0.5597848 0.5599404 0.5600830 
  99.548%   99.549%   99.550%   99.551%   99.552%   99.553%   99.554%   99.555% 
0.5602242 0.5603783 0.5605267 0.5606722 0.5608191 0.5609719 0.5611246 0.5612729 
  99.556%   99.557%   99.558%   99.559%   99.560%   99.561%   99.562%   99.563% 
0.5614213 0.5615654 0.5617123 0.5618668 0.5620149 0.5621690 0.5623246 0.5624788 
  99.564%   99.565%   99.566%   99.567%   99.568%   99.569%   99.570%   99.571% 
0.5626329 0.5627885 0.5629412 0.5630910 0.5632495 0.5634051 0.5635535 0.5637091 
  99.572%   99.573%   99.574%   99.575%   99.576%   99.577%   99.578%   99.579% 
0.5638661 0.5640173 0.5641773 0.5643300 0.5644870 0.5646440 0.5648010 0.5649595 
  99.580%   99.581%   99.582%   99.583%   99.584%   99.585%   99.586%   99.587% 
0.5651209 0.5652736 0.5654349 0.5655934 0.5657591 0.5659176 0.5660847 0.5662431 
  99.588%   99.589%   99.590%   99.591%   99.592%   99.593%   99.594%   99.595% 
0.5664160 0.5665759 0.5667401 0.5669015 0.5670642 0.5672300 0.5673884 0.5675544 
  99.596%   99.597%   99.598%   99.599%   99.600%   99.601%   99.602%   99.603% 
0.5677212 0.5678811 0.5680482 0.5682283 0.5683897 0.5685597 0.5687340 0.5689068 
  99.604%   99.605%   99.606%   99.607%   99.608%   99.609%   99.610%   99.611% 
0.5690696 0.5692324 0.5694039 0.5695681 0.5697260 0.5698923 0.5700694 0.5702409 
  99.612%   99.613%   99.614%   99.615%   99.616%   99.617%   99.618%   99.619% 
0.5704094 0.5705751 0.5707437 0.5709165 0.5710836 0.5712542 0.5714308 0.5716008 
  99.620%   99.621%   99.622%   99.623%   99.624%   99.625%   99.626%   99.627% 
0.5717636 0.5719322 0.5721036 0.5722722 0.5724465 0.5726194 0.5727865 0.5729680 
  99.628%   99.629%   99.630%   99.631%   99.632%   99.633%   99.634%   99.635% 
0.5731423 0.5733195 0.5734981 0.5736782 0.5738612 0.5740398 0.5742177 0.5744000 
  99.636%   99.637%   99.638%   99.639%   99.640%   99.641%   99.642%   99.643% 
0.5745671 0.5747453 0.5749258 0.5751073 0.5752888 0.5754718 0.5756504 0.5758406 
  99.644%   99.645%   99.646%   99.647%   99.648%   99.649%   99.650%   99.651% 
0.5760192 0.5761921 0.5763664 0.5765465 0.5767324 0.5769106 0.5771026 0.5772985 
  99.652%   99.653%   99.654%   99.655%   99.656%   99.657%   99.658%   99.659% 
0.5774858 0.5776745 0.5778589 0.5780433 0.5782321 0.5784251 0.5786095 0.5788011 
  99.660%   99.661%   99.662%   99.663%   99.664%   99.665%   99.666%   99.667% 
0.5789869 0.5791843 0.5793759 0.5795661 0.5797562 0.5799464 0.5801351 0.5803325 
  99.668%   99.669%   99.670%   99.671%   99.672%   99.673%   99.674%   99.675% 
0.5805270 0.5807171 0.5809102 0.5810903 0.5812891 0.5814850 0.5816925 0.5818956 
  99.676%   99.677%   99.678%   99.679%   99.680%   99.681%   99.682%   99.683% 
0.5821016 0.5822937 0.5824816 0.5826778 0.5828790 0.5830884 0.5832916 0.5834846 
  99.684%   99.685%   99.686%   99.687%   99.688%   99.689%   99.690%   99.691% 
0.5836762 0.5838793 0.5840796 0.5842769 0.5844772 0.5846861 0.5848892 0.5851068 
  99.692%   99.693%   99.694%   99.695%   99.696%   99.697%   99.698%   99.699% 
0.5853185 0.5855289 0.5857334 0.5859423 0.5861555 0.5863587 0.5865848 0.5867880 
  99.700%   99.701%   99.702%   99.703%   99.704%   99.705%   99.706%   99.707% 
0.5869925 0.5871942 0.5874103 0.5876336 0.5878396 0.5880514 0.5882747 0.5884865 
  99.708%   99.709%   99.710%   99.711%   99.712%   99.713%   99.714%   99.715% 
0.5887127 0.5889331 0.5891448 0.5893552 0.5895669 0.5897744 0.5899991 0.5902268 
  99.716%   99.717%   99.718%   99.719%   99.720%   99.721%   99.722%   99.723% 
0.5904582 0.5906806 0.5909117 0.5911329 0.5913548 0.5915795 0.5918001 0.5920347 
  99.724%   99.725%   99.726%   99.727%   99.728%   99.729%   99.730%   99.731% 
0.5922566 0.5924885 0.5927234 0.5929481 0.5931772 0.5934134 0.5936411 0.5938658 
  99.732%   99.733%   99.734%   99.735%   99.736%   99.737%   99.738%   99.739% 
0.5940934 0.5943120 0.5945357 0.5947719 0.5950125 0.5952488 0.5954822 0.5957127 
  99.740%   99.741%   99.742%   99.743%   99.744%   99.745%   99.746%   99.747% 
0.5959360 0.5961751 0.5964099 0.5966563 0.5969070 0.5971576 0.5974054 0.5976575 
  99.748%   99.749%   99.750%   99.751%   99.752%   99.753%   99.754%   99.755% 
0.5978996 0.5981618 0.5984049 0.5986476 0.5989022 0.5991486 0.5993978 0.5996514 
  99.756%   99.757%   99.758%   99.759%   99.760%   99.761%   99.762%   99.763% 
0.5998963 0.6001469 0.6004077 0.6006800 0.6009350 0.6012015 0.6014648 0.6017288 
  99.764%   99.765%   99.766%   99.767%   99.768%   99.769%   99.770%   99.771% 
0.6019751 0.6022344 0.6025016 0.6027660 0.6030354 0.6032947 0.6035612 0.6038364 
  99.772%   99.773%   99.774%   99.775%   99.776%   99.777%   99.778%   99.779% 
0.6040914 0.6043550 0.6046201 0.6048866 0.6051531 0.6054197 0.6056934 0.6059657 
  99.780%   99.781%   99.782%   99.783%   99.784%   99.785%   99.786%   99.787% 
0.6062365 0.6065059 0.6067839 0.6070620 0.6073328 0.6076022 0.6078788 0.6081629 
  99.788%   99.789%   99.790%   99.791%   99.792%   99.793%   99.794%   99.795% 
0.6084435 0.6087288 0.6090328 0.6093324 0.6096224 0.6099144 0.6102198 0.6105094 
  99.796%   99.797%   99.798%   99.799%   99.800%   99.801%   99.802%   99.803% 
0.6108163 0.6111015 0.6114124 0.6117195 0.6120278 0.6123174 0.6126243 0.6129325 
  99.804%   99.805%   99.806%   99.807%   99.808%   99.809%   99.810%   99.811% 
0.6132528 0.6135607 0.6138805 0.6141795 0.6144956 0.6147938 0.6151134 0.6154176 
  99.812%   99.813%   99.814%   99.815%   99.816%   99.817%   99.818%   99.819% 
0.6157441 0.6160689 0.6163872 0.6167243 0.6170412 0.6173683 0.6177111 0.6180454 
  99.820%   99.821%   99.822%   99.823%   99.824%   99.825%   99.826%   99.827% 
0.6210798 0.6214208 0.6217593 0.6221051 0.6224522 0.6227894 0.6231365 0.6235010 
  99.836%   99.837%   99.838%   99.839%   99.840%   99.841%   99.842%   99.843% 
0.6238641 0.6242041 0.6245541 0.6249056 0.6252586 0.6256476 0.6259962 0.6263722 
  99.844%   99.845%   99.846%   99.847%   99.848%   99.849%   99.850%   99.851% 
0.6267439 0.6271184 0.6274884 0.6278762 0.6282594 0.6286542 0.6290374 0.6294219 
  99.852%   99.853%   99.854%   99.855%   99.856%   99.857%   99.858%   99.859% 
0.6298168 0.6302100 0.6305947 0.6309859 0.6313582 0.6317371 0.6321347 0.6325251 
  99.860%   99.861%   99.862%   99.863%   99.864%   99.865%   99.866%   99.867% 
0.6329199 0.6333477 0.6337526 0.6341718 0.6345867 0.6350232 0.6354496 0.6358645 
  99.868%   99.869%   99.870%   99.871%   99.872%   99.873%   99.874%   99.875% 
0.6362809 0.6367246 0.6371669 0.6376051 0.6380586 0.6385038 0.6389705 0.6394157 
  99.876%   99.877%   99.878%   99.879%   99.880%   99.881%   99.882%   99.883% 
0.6398724 0.6403186 0.6407643 0.6412338 0.6417221 0.6422154 0.6426773 0.6431584 
  99.884%   99.885%   99.886%   99.887%   99.888%   99.889%   99.890%   99.891% 
0.6436411 0.6441438 0.6446250 0.6451046 0.6456075 0.6461002 0.6465929 0.6471124 
  99.892%   99.893%   99.894%   99.895%   99.896%   99.897%   99.898%   99.899% 
0.6476388 0.6481718 0.6487046 0.6492465 0.6497882 0.6502853 0.6508168 0.6513628 
  99.900%   99.901%   99.902%   99.903%   99.904%   99.905%   99.906%   99.907% 
0.6519088 0.6524707 0.6530558 0.6536073 0.6541620 0.6547224 0.6552900 0.6558752 
  99.908%   99.909%   99.910%   99.911%   99.912%   99.913%   99.914%   99.915% 
0.6564670 0.6570750 0.6576505 0.6582505 0.6588560 0.6594779 0.6600902 0.6607039 
  99.916%   99.917%   99.918%   99.919%   99.920%   99.921%   99.922%   99.923% 
0.6613392 0.6619694 0.6626300 0.6632902 0.6639612 0.6646498 0.6653298 0.6660069 
  99.924%   99.925%   99.926%   99.927%   99.928%   99.929%   99.930%   99.931% 
0.6667027 0.6673827 0.6680871 0.6688305 0.6695595 0.6703005 0.6710419 0.6717737 
  99.932%   99.933%   99.934%   99.935%   99.936%   99.937%   99.938%   99.939% 
0.6725454 0.6733065 0.6740441 0.6748552 0.6756567 0.6764986 0.6773002 0.6781292 
  99.940%   99.941%   99.942%   99.943%   99.944%   99.945%   99.946%   99.947% 
0.6789812 0.6798778 0.6807013 0.6816208 0.6825621 0.6834775 0.6844484 0.6853773 
  99.948%   99.949%   99.950%   99.951%   99.952%   99.953%   99.954%   99.955% 
0.6863471 0.6873149 0.6883383 0.6893157 0.6903694 0.6914352 0.6924943 0.6936180 
  99.956%   99.957%   99.958%   99.959%   99.960%   99.961%   99.962%   99.963% 
0.6946937 0.6958006 0.6968954 0.6980853 0.6992566 0.7005485 0.7018887 0.7031752 
  99.964%   99.965%   99.966%   99.967%   99.968%   99.969%   99.970%   99.971% 
0.7044904 0.7059008 0.7072810 0.7087536 0.7102280 0.7116940 0.7132502 0.7148989 
  99.972%   99.973%   99.974%   99.975%   99.976%   99.977%   99.978%   99.979% 
0.7165817 0.7181865 0.7199847 0.7218350 0.7236494 0.7256188 0.7276541 0.7297418 
  99.980%   99.981%   99.982%   99.983%   99.984%   99.985%   99.986%   99.987% 
0.7318869 0.7342510 0.7365654 0.7392313 0.7420007 0.7449196 0.7478823 0.7510164 
  99.988%   99.989%   99.990%   99.991%   99.992%   99.993%   99.994%   99.995% 
0.7546028 0.7583468 0.7623229 0.7665802 0.7712325 0.7766666 0.7828810 0.7898287 
  99.996%   99.997%   99.998%   99.999%  100.000% 
0.7980186 0.8081205 0.8223848 0.8435042 0.9679099

99.987% = 0.7510164
mi2p(0.7510164, 86)
p-value 6.215066e-34

gen_gen_sanos[gen_gen_sanos < 0.7510164] <- 0

### red final sanos

((sum(gen_gen_sanos != 0)) + (sum(mir_gen_sanos != 0)))/2
mir_gen_sanos[genes, genes]<- gen_gen_sanos
sum(mir_gen_sanos != 0)/2
sanos_pvalue <- mir_gen_sanos
write.table(sanos_pvalue, file = "sanos_pvalue_full_adjmtx.txt", sep = "\t", col.names= NA, row.names= T, quote = F)

#### enfermos

enfermos_q <- enfermos[upper.tri(enfermos, diag=FALSE)]
quantile(enfermos_q)

> quantile(enfermos_q)
        0%        25%        50%        75%       100% 
0.00000000 0.03884466 0.05499560 0.07920962 1.00000000 

mir_gen_enfermos <- enfermos
mir_gen_enfermos[genes, genes] <- NA
gen_gen_enfermos <- enfermos[genes, genes]
isSymmetric(mir_gen_enfermos)
isSymmetric(gen_gen_enfermos)
dim(enfermos)
dim(mir_gen_enfermos)
dim(gen_gen_enfermos)
identical(sum(enfermos != 0), (sum(mir_gen_enfermos != 0, na.rm=T))+sum(gen_gen_enfermos != 0))

mirnas_enfermos_q <- mir_gen_enfermos[upper.tri(mir_gen_enfermos, diag=FALSE)]
genes_enfermos_q <- gen_gen_enfermos[upper.tri(gen_gen_enfermos, diag=FALSE)]

quantile(mirnas_enfermos_q, na.rm=T)
quantile(genes_enfermos_q)

> quantile(mirnas_enfermos_q, na.rm=T)
        0%        25%        50%        75%       100% 
0.00000000 0.03422378 0.04704662 0.06478317 1.00000000 
> quantile(genes_enfermos_q)
        0%        25%        50%        75%       100% 
0.00000000 0.03934299 0.05580676 0.08054543 0.95806784 

# filtro

quantile(mirnas_enfermos_q, probs=seq(0.995, 1, 0.00001), na.rm=T)

> quantile(mirnas_enfermos_q, probs=seq(0.995, 1, 0.00001), na.rm=T)
99.500%   99.501%   99.502%   99.503%   99.504%   99.505%   99.506%   99.507% 
0.1819430 0.1820394 0.1821243 0.1822047 0.1822922 0.1823883 0.1824855 0.1825704 
  99.508%   99.509%   99.510%   99.511%   99.512%   99.513%   99.514%   99.515% 
0.1826552 0.1827344 0.1828137 0.1829028 0.1830006 0.1831013 0.1831978 0.1832884 
  99.516%   99.517%   99.518%   99.519%   99.520%   99.521%   99.522%   99.523% 
0.1833733 0.1834701 0.1835662 0.1836467 0.1837345 0.1838402 0.1839109 0.1839907 
  99.524%   99.525%   99.526%   99.527%   99.528%   99.529%   99.530%   99.531% 
0.1840799 0.1841605 0.1842526 0.1843466 0.1844326 0.1845257 0.1846195 0.1847231 
  99.532%   99.533%   99.534%   99.535%   99.536%   99.537%   99.538%   99.539% 
0.1848109 0.1849076 0.1850152 0.1851157 0.1852199 0.1853016 0.1854009 0.1854901 
  99.540%   99.541%   99.542%   99.543%   99.544%   99.545%   99.546%   99.547% 
0.1855672 0.1856781 0.1857750 0.1858719 0.1859606 0.1860771 0.1861679 0.1862528 
  99.548%   99.549%   99.550%   99.551%   99.552%   99.553%   99.554%   99.555% 
0.1863396 0.1864429 0.1865377 0.1866208 0.1867060 0.1868111 0.1869019 0.1870010 
  99.556%   99.557%   99.558%   99.559%   99.560%   99.561%   99.562%   99.563% 
0.1871161 0.1872240 0.1873370 0.1874342 0.1875234 0.1876398 0.1877446 0.1878472 
  99.564%   99.565%   99.566%   99.567%   99.568%   99.569%   99.570%   99.571% 
0.1879422 0.1880546 0.1881664 0.1882875 0.1884063 0.1885217 0.1886188 0.1887164 
  99.572%   99.573%   99.574%   99.575%   99.576%   99.577%   99.578%   99.579% 
0.1888314 0.1889379 0.1890401 0.1891293 0.1892228 0.1893162 0.1894138 0.1895063 
  99.580%   99.581%   99.582%   99.583%   99.584%   99.585%   99.586%   99.587% 
0.1896387 0.1897394 0.1898530 0.1899625 0.1900762 0.1901780 0.1902978 0.1904028 
  99.588%   99.589%   99.590%   99.591%   99.592%   99.593%   99.594%   99.595% 
0.1905035 0.1906215 0.1907309 0.1908320 0.1909453 0.1910458 0.1911391 0.1912763 
  99.596%   99.597%   99.598%   99.599%   99.600%   99.601%   99.602%   99.603% 
0.1913688 0.1914838 0.1915970 0.1917263 0.1918397 0.1919555 0.1920926 0.1921914 
  99.604%   99.605%   99.606%   99.607%   99.608%   99.609%   99.610%   99.611% 
0.1923077 0.1924203 0.1925245 0.1926318 0.1927455 0.1928462 0.1929690 0.1930800 
  99.612%   99.613%   99.614%   99.615%   99.616%   99.617%   99.618%   99.619% 
0.1931761 0.1932995 0.1934159 0.1935384 0.1936679 0.1937758 0.1938954 0.1940291 
  99.620%   99.621%   99.622%   99.623%   99.624%   99.625%   99.626%   99.627% 
0.1941381 0.1942521 0.1943658 0.1945007 0.1946565 0.1947828 0.1948953 0.1950140 
  99.628%   99.629%   99.630%   99.631%   99.632%   99.633%   99.634%   99.635% 
0.1951403 0.1952824 0.1954103 0.1955328 0.1956616 0.1957822 0.1959014 0.1960374 
  99.636%   99.637%   99.638%   99.639%   99.640%   99.641%   99.642%   99.643% 
0.1961749 0.1963156 0.1964552 0.1965792 0.1967142 0.1968276 0.1969822 0.1970961 
  99.644%   99.645%   99.646%   99.647%   99.648%   99.649%   99.650%   99.651% 
0.1972110 0.1973475 0.1974752 0.1975939 0.1977243 0.1978827 0.1979968 0.1981345 
  99.652%   99.653%   99.654%   99.655%   99.656%   99.657%   99.658%   99.659% 
0.1982449 0.1983785 0.1985115 0.1986156 0.1987503 0.1988962 0.1990146 0.1991395 
  99.660%   99.661%   99.662%   99.663%   99.664%   99.665%   99.666%   99.667% 
0.1992788 0.1994066 0.1995344 0.1996967 0.1998260 0.1999653 0.2001075 0.2002407 
  99.668%   99.669%   99.670%   99.671%   99.672%   99.673%   99.674%   99.675% 
0.2003737 0.2005333 0.2006901 0.2008342 0.2009878 0.2011363 0.2012672 0.2014226 
  99.676%   99.677%   99.678%   99.679%   99.680%   99.681%   99.682%   99.683% 
0.2015826 0.2017320 0.2018626 0.2020068 0.2021448 0.2022716 0.2024054 0.2025865 
  99.684%   99.685%   99.686%   99.687%   99.688%   99.689%   99.690%   99.691% 
0.2027215 0.2028630 0.2030304 0.2031869 0.2033665 0.2035278 0.2036883 0.2038377 
  99.692%   99.693%   99.694%   99.695%   99.696%   99.697%   99.698%   99.699% 
0.2039919 0.2041206 0.2042988 0.2044632 0.2046537 0.2048480 0.2049957 0.2051755 
99.700%   99.701%   99.702%   99.703%   99.704%   99.705%   99.706%   99.707% 
0.2053515 0.2055279 0.2056933 0.2058650 0.2060344 0.2061758 0.2063325 0.2065022 
  99.708%   99.709%   99.710%   99.711%   99.712%   99.713%   99.714%   99.715% 
0.2066461 0.2068317 0.2070030 0.2071868 0.2073699 0.2075276 0.2076966 0.2078690 
  99.716%   99.717%   99.718%   99.719%   99.720%   99.721%   99.722%   99.723% 
0.2080549 0.2082520 0.2084251 0.2085803 0.2087370 0.2089399 0.2091212 0.2092608 
  99.724%   99.725%   99.726%   99.727%   99.728%   99.729%   99.730%   99.731% 
0.2094421 0.2096076 0.2097756 0.2099560 0.2101666 0.2103511 0.2105314 0.2107225 
  99.732%   99.733%   99.734%   99.735%   99.736%   99.737%   99.738%   99.739% 
0.2109280 0.2111318 0.2113566 0.2115113 0.2117438 0.2119498 0.2121279 0.2123332 
  99.740%   99.741%   99.742%   99.743%   99.744%   99.745%   99.746%   99.747% 
0.2125245 0.2127329 0.2129646 0.2131655 0.2133734 0.2135794 0.2137720 0.2139627 
  99.748%   99.749%   99.750%   99.751%   99.752%   99.753%   99.754%   99.755% 
0.2141988 0.2144230 0.2146688 0.2148571 0.2150817 0.2152824 0.2154945 0.2157294 
  99.756%   99.757%   99.758%   99.759%   99.760%   99.761%   99.762%   99.763% 
0.2159621 0.2161951 0.2163679 0.2165861 0.2168178 0.2170360 0.2172615 0.2174788 
  99.764%   99.765%   99.766%   99.767%   99.768%   99.769%   99.770%   99.771% 
0.2176984 0.2179145 0.2181615 0.2183969 0.2186549 0.2188948 0.2191357 0.2193596 
  99.772%   99.773%   99.774%   99.775%   99.776%   99.777%   99.778%   99.779% 
0.2196201 0.2198330 0.2200901 0.2203604 0.2205731 0.2207948 0.2210402 0.2212903 
  99.780%   99.781%   99.782%   99.783%   99.784%   99.785%   99.786%   99.787% 
0.2215344 0.2217724 0.2220124 0.2222635 0.2224851 0.2227171 0.2229858 0.2232872 
  99.788%   99.789%   99.790%   99.791%   99.792%   99.793%   99.794%   99.795% 
0.2235342 0.2237927 0.2240123 0.2242730 0.2245241 0.2248251 0.2251312 0.2254017 
  99.796%   99.797%   99.798%   99.799%   99.800%   99.801%   99.802%   99.803% 
0.2256826 0.2259339 0.2262094 0.2264422 0.2267338 0.2270095 0.2272420 0.2275259 
  99.804%   99.805%   99.806%   99.807%   99.808%   99.809%   99.810%   99.811% 
0.2277432 0.2280439 0.2283772 0.2286857 0.2289800 0.2292357 0.2295073 0.2297443 
  99.812%   99.813%   99.814%   99.815%   99.816%   99.817%   99.818%   99.819% 
0.2300175 0.2303338 0.2306431 0.2309892 0.2312859 0.2316592 0.2319831 0.2322290 
  99.820%   99.821%   99.822%   99.823%   99.824%   99.825%   99.826%   99.827% 
0.2325105 0.2328098 0.2330683 0.2333614 0.2337278 0.2340692 0.2344347 0.2347275 
  99.828%   99.829%   99.830%   99.831%   99.832%   99.833%   99.834%   99.835% 
0.2349884 0.2352804 0.2355859 0.2359105 0.2362601 0.2366081 0.2369168 0.2372350 
  99.836%   99.837%   99.838%   99.839%   99.840%   99.841%   99.842%   99.843% 
0.2375815 0.2378946 0.2382227 0.2385750 0.2389081 0.2393083 0.2397096 0.2400292 
  99.844%   99.845%   99.846%   99.847%   99.848%   99.849%   99.850%   99.851% 
0.2403457 0.2407809 0.2411706 0.2415156 0.2418621 0.2422654 0.2426141 0.2429874 
  99.852%   99.853%   99.854%   99.855%   99.856%   99.857%   99.858%   99.859% 
0.2433447 0.2437559 0.2441682 0.2445655 0.2449707 0.2453823 0.2457763 0.2462063 
  99.860%   99.861%   99.862%   99.863%   99.864%   99.865%   99.866%   99.867% 
0.2466334 0.2470540 0.2474849 0.2478940 0.2483375 0.2487812 0.2491984 0.2496521 
  99.868%   99.869%   99.870%   99.871%   99.872%   99.873%   99.874%   99.875% 
0.2501181 0.2506166 0.2510877 0.2516020 0.2520055 0.2525082 0.2529583 0.2534404 
  99.876%   99.877%   99.878%   99.879%   99.880%   99.881%   99.882%   99.883% 
0.2539548 0.2544467 0.2549688 0.2555310 0.2560058 0.2565466 0.2570342 0.2574806 
  99.884%   99.885%   99.886%   99.887%   99.888%   99.889%   99.890%   99.891% 
0.2581001 0.2586148 0.2591967 0.2597895 0.2603180 0.2608239 0.2614401 0.2619560 
  99.892%   99.893%   99.894%   99.895%   99.896%   99.897%   99.898%   99.899% 
0.2625664 0.2631982 0.2638648 0.2645127 0.2650602 0.2656871 0.2664179 0.2670968 
  99.900%   99.901%   99.902%   99.903%   99.904% 
0.2656871 0.2664179 0.2670968 0.2677109 0.2683311 0.2689601 0.2694991 0.2702011 
  99.905%   99.906%   99.907%   99.908%   99.909%   99.910%   99.911%   99.912% 
0.2709111 0.2716151 0.2723066 0.2729098 0.2735700 0.2743276 0.2751664 0.2759626 
  99.913%   99.914%   99.915%   99.916%   99.917%   99.918%   99.919%   99.920% 
0.2766955 0.2773912 0.2780981 0.2788773 0.2796101 0.2803655 0.2811747 0.2820099 
  99.921%   99.922%   99.923%   99.924%   99.925%   99.926%   99.927%   99.928% 
0.2829354 0.2840456 0.2851435 0.2860401 0.2869863 0.2878750 0.2887321 0.2897587 
  99.929%   99.930%   99.931%   99.932%   99.933%   99.934%   99.935%   99.936% 
0.2906633 0.2915919 0.2925775 0.2936020 0.2944388 0.2955625 0.2967289 0.2976711 
  99.937%   99.938%   99.939%   99.940%   99.941%   99.942%   99.943%   99.944% 
0.2986967 0.2998533 0.3008799 0.3019254 0.3034200 0.3046956 0.3059556 0.3071304 
  99.945%   99.946%   99.947%   99.948%   99.949%   99.950%   99.951%   99.952% 
0.3084747 0.3098677 0.3111356 0.3126343 0.3140918 0.3153006 0.3166746 0.3178733 
  99.953%   99.954%   99.955%   99.956%   99.957%   99.958%   99.959%   99.960% 
0.3193447 0.3211097 0.3227704 0.3244528 0.3263531 0.3280922 0.3296616 0.3313176 
  99.961%   99.962%   99.963%   99.964%   99.965%   99.966%   99.967%   99.968% 
0.3332812 0.3348359 0.3368804 0.3394510 0.3413184 0.3432482 0.3454872 0.3475443 
  99.969%   99.970%   99.971%   99.972%   99.973%   99.974%   99.975%   99.976% 
0.3497785 0.3521068 0.3547347 0.3570791 0.3596865 0.3626065 0.3654775 0.3682217 
  99.977%   99.978%   99.979%   99.980%   99.981%   99.982%   99.983%   99.984% 
0.3715291 0.3749058 0.3776493 0.3810611 0.3852372 0.3891399 0.3931158 0.3968326 
  99.985%   99.986%   99.987%   99.988%   99.989%   99.990%   99.991%   99.992% 
0.4006006 0.4052156 0.4104305 0.4163643 0.4222367 0.4295637 0.4374766 0.4476851 
  99.993%   99.994%   99.995%   99.996%   99.997%   99.998%   99.999%  100.000% 
0.4563647 0.4675645 0.4770575 0.4960702 0.5207274 0.5492774 0.6027598 1.0000000 

99.741% = 0.2127329
sum(mirnas_enfermos_q > 0.2127329, na.rm=TRUE)
[1] 25334

mi2p(0.2127329, 86)
p-value 8.404019e-10

dim(mir_gen_enfermos)
mir_gen_enfermos[is.na(mir_gen_enfermos)] <- 0
mir_gen_enfermos[mir_gen_enfermos < 0.2127329 ] <- 0

(sum(mir_gen_enfermos != 0))/2
sum(mirnas_enfermos_q > 0.2127329, na.rm=TRUE)


quantile(genes_enfermos_q, probs=seq(0.995, 1, 0.00001))

> quantile(genes_enfermos_q, probs=seq(0.995, 1, 0.00001))
  99.500%   99.501%   99.502%   99.503%   99.504%   99.505%   99.506%   99.507% 
0.2695789 0.2697243 0.2698638 0.2700077 0.2701473 0.2702797 0.2704164 0.2705675 
  99.508%   99.509%   99.510%   99.511%   99.512%   99.513%   99.514%   99.515% 
0.2707085 0.2708538 0.2709977 0.2711416 0.2712812 0.2714194 0.2715690 0.2717115 
  99.516%   99.517%   99.518%   99.519%   99.520%   99.521%   99.522%   99.523% 
0.2718583 0.2720065 0.2721532 0.2723058 0.2724583 0.2726008 0.2727519 0.2728986 
  99.524%   99.525%   99.526%   99.527%   99.528%   99.529%   99.530%   99.531% 
0.2730454 0.2731922 0.2733404 0.2734901 0.2736440 0.2737951 0.2739433 0.2740988 
  99.532%   99.533%   99.534%   99.535%   99.536%   99.537%   99.538%   99.539% 
0.2742484 0.2743938 0.2745448 0.2747017 0.2748600 0.2750168 0.2751651 0.2753277 
  99.540%   99.541%   99.542%   99.543%   99.544%   99.545%   99.546%   99.547% 
0.2754816 0.2756342 0.2757881 0.2759421 0.2760990 0.2762572 0.2764170 0.2765781 
  99.548%   99.549%   99.550%   99.551%   99.552%   99.553%   99.554%   99.555% 
0.2767336 0.2768918 0.2770544 0.2772171 0.2773858 0.2775466 0.2777020 0.2778588 
  99.556%   99.557%   99.558%   99.559%   99.560%   99.561%   99.562%   99.563% 
0.2780171 0.2781797 0.2783409 0.2785006 0.2786618 0.2788258 0.2789956 0.2791568 
  99.564%   99.565%   99.566%   99.567%   99.568%   99.569%   99.570%   99.571% 
0.2793280 0.2794935 0.2796633 0.2798317 0.2799986 0.2801771 0.2803440 0.2805141 
  99.572%   99.573%   99.574%   99.575%   99.576%   99.577%   99.578%   99.579% 
0.2806994 0.2808678 0.2810361 0.2812174 0.2813930 0.2815642 0.2817456 0.2819168 
  99.580%   99.581%   99.582%   99.583%   99.584%   99.585%   99.586%   99.587% 
0.2820880 0.2822665 0.2824377 0.2826190 0.2827975 0.2829744 0.2831471 0.2833328 
  99.588%   99.589%   99.590%   99.591%   99.592%   99.593%   99.594%   99.595% 
0.2835141 0.2836925 0.2838695 0.2840479 0.2842278 0.2844149 0.2845991 0.2847789 
  99.596%   99.597%   99.598%   99.599%   99.600%   99.601%   99.602%   99.603% 
0.2849675 0.2851488 0.2853358 0.2855287 0.2857161 0.2859071 0.2860999 0.2862827 
  99.604%   99.605%   99.606%   99.607%   99.608%   99.609%   99.610%   99.611% 
0.2864726 0.2866669 0.2868626 0.2870511 0.2872511 0.2874483 0.2876397 0.2878339 
  99.612%   99.613%   99.614%   99.615%   99.616%   99.617%   99.618%   99.619% 
0.2880296 0.2882321 0.2884253 0.2886138 0.2888066 0.2890043 0.2892053 0.2893998 
  99.620%   99.621%   99.622%   99.623%   99.624%   99.625%   99.626%   99.627% 
0.2895981 0.2897968 0.2899996 0.2901924 0.2903939 0.2905939 0.2907898 0.2909867 
  99.628%   99.629%   99.630%   99.631%   99.632%   99.633%   99.634%   99.635% 
0.2911882 0.2913954 0.2916041 0.2918041 0.2920055 0.2922099 0.2924099 0.2926142 
  99.636%   99.637%   99.638%   99.639%   99.640%   99.641%   99.642%   99.643% 
0.2928287 0.2930431 0.2932546 0.2934690 0.2936777 0.2938926 0.2940978 0.2943151 
  99.644%   99.645%   99.646%   99.647%   99.648%   99.649%   99.650%   99.651% 
0.2945382 0.2947511 0.2949670 0.2951684 0.2953800 0.2955973 0.2958289 0.2960577 
  99.652%   99.653%   99.654%   99.655%   99.656%   99.657%   99.658%   99.659% 
0.2962865 0.2965168 0.2967470 0.2969701 0.2971989 0.2974277 0.2976579 0.2978910 
  99.660%   99.661%   99.662%   99.663%   99.664%   99.665%   99.666%   99.667% 
0.2981328 0.2983716 0.2986120 0.2988422 0.2990796 0.2993271 0.2995631 0.2997994 
  99.668%   99.669%   99.670%   99.671%   99.672%   99.673%   99.674%   99.675% 
0.3000337 0.3002697 0.3005172 0.3007661 0.3010040 0.3012535 0.3015031 0.3017360 
  99.676%   99.677%   99.678%   99.679%   99.680%   99.681%   99.682%   99.683% 
0.3019706 0.3022157 0.3024728 0.3027145 0.3029649 0.3032066 0.3034542 0.3037089 
  99.684%   99.685%   99.686%   99.687%   99.688%   99.689%   99.690%   99.691% 
0.3039582 0.3042154 0.3044586 0.3047089 0.3049694 0.3052198 0.3054702 0.3057306 
  99.692%   99.693%   99.694%   99.695%   99.696%   99.697%   99.698%   99.699% 
0.3059925 0.3062573 0.3065264 0.3067969 0.3070588 0.3073193 0.3075912 0.3078603 
  99.700%   99.701%   99.702%   99.703%   99.704%   99.705%   99.706%   99.707% 
0.3081366 0.3084091 0.3086820 0.3089511 0.3092231 0.3095008 0.3097641 0.3100375 
  99.708%   99.709%   99.710%   99.711%   99.712%   99.713%   99.714%   99.715% 
0.3103196 0.3106055 0.3108865 0.3111679 0.3114448 0.3117197 0.3120133 0.3123097 
  99.716%   99.717%   99.718%   99.719%   99.720%   99.721%   99.722%   99.723% 
0.3126018 0.3128896 0.3131875 0.3134809 0.3137775 0.3140634 0.3143559 0.3146503 
  99.724%   99.725%   99.726%   99.727%   99.728%   99.729%   99.730%   99.731% 
0.3149488 0.3152616 0.3155704 0.3158640 0.3161676 0.3164597 0.3167634 0.3170756 
  99.732%   99.733%   99.734%   99.735%   99.736%   99.737%   99.738%   99.739% 
0.3173735 0.3177059 0.3180196 0.3183563 0.3186916 0.3189895 0.3193205 0.3196428 
  99.740%   99.741%   99.742%   99.743%   99.744%   99.745%   99.746%   99.747% 
0.3199594 0.3202961 0.3206220 0.3209782 0.3213034 0.3216329 0.3219653 0.3222992 
  99.748%   99.749%   99.750%   99.751%   99.752%   99.753%   99.754%   99.755% 
0.3226388 0.3229611 0.3232975 0.3236317 0.3239765 0.3243166 0.3246540 0.3250059 
  99.756%   99.757%   99.758%   99.759%   99.760%   99.761%   99.762%   99.763% 
0.3253642 0.3257024 0.3260578 0.3264175 0.3267787 0.3271356 0.3275181 0.3278767 
  99.764%   99.765%   99.766%   99.767%   99.768%   99.769%   99.770%   99.771% 
0.3282273 0.3286178 0.3289847 0.3293689 0.3297589 0.3301197 0.3305057 0.3308821 
  99.772%   99.773%   99.774%   99.775%   99.776%   99.777%   99.778%   99.779% 
0.3312583 0.3316373 0.3320106 0.3323897 0.3327822 0.3331765 0.3335636 0.3339636 
  99.780%   99.781%   99.782%   99.783%   99.784%   99.785%   99.786%   99.787% 
0.3343579 0.3347479 0.3351479 0.3355364 0.3359480 0.3363379 0.3367524 0.3371729 
  99.788%   99.789%   99.790%   99.791%   99.792%   99.793%   99.794%   99.795% 
0.3375971 0.3380057 0.3384144 0.3388546 0.3392826 0.3397221 0.3401513 0.3406031 
  99.796%   99.797%   99.798%   99.799%   99.800%   99.801%   99.802%   99.803% 
0.3410406 0.3414915 0.3419371 0.3423820 0.3428321 0.3432883 0.3437516 0.3441977 
  99.804%   99.805%   99.806%   99.807%   99.808%   99.809%   99.810%   99.811% 
0.3446553 0.3451096 0.3455878 0.3460511 0.3465260 0.3469937 0.3474556 0.3479261 
  99.812%   99.813%   99.814%   99.815%   99.816%   99.817%   99.818%   99.819% 
0.3484255 0.3489090 0.3493809 0.3498859 0.3503724 0.3508631 0.3513524 0.3518410 
  99.820%   99.821%   99.822%   99.823%   99.824%   99.825%   99.826%   99.827% 
0.3565701 0.3571141 0.3576595 0.3581976 0.3587186 0.3592941 0.3598539 0.3604370 
  99.836%   99.837%   99.838%   99.839%   99.840%   99.841%   99.842%   99.843% 
0.3609950 0.3615548 0.3621383 0.3627433 0.3633262 0.3639032 0.3645234 0.3651595 
  99.844%   99.845%   99.846%   99.847%   99.848%   99.849%   99.850%   99.851% 
0.3657149 0.3663236 0.3669381 0.3675352 0.3681483 0.3687713 0.3694117 0.3700333 
  99.852%   99.853%   99.854%   99.855%   99.856%   99.857%   99.858%   99.859% 
0.3706233 0.3712665 0.3719055 0.3725357 0.3732121 0.3738610 0.3745098 0.3752453 
  99.860%   99.861%   99.862%   99.863%   99.864%   99.865%   99.866%   99.867% 
0.3758972 0.3765606 0.3772635 0.3779606 0.3786601 0.3793810 0.3801120 0.3808200 
  99.868%   99.869%   99.870%   99.871%   99.872%   99.873%   99.874%   99.875% 
0.3815294 0.3822596 0.3829598 0.3837527 0.3845263 0.3853025 0.3860413 0.3868163 
  99.876%   99.877%   99.878%   99.879%   99.880%   99.881%   99.882%   99.883% 
0.3875761 0.3883344 0.3891131 0.3898828 0.3906526 0.3915160 0.3923391 0.3931427 
  99.884%   99.885%   99.886%   99.887%   99.888%   99.889%   99.890%   99.891% 
0.3940150 0.3948429 0.3956668 0.3965480 0.3974274 0.3983422 0.3992650 0.4001442 
  99.892%   99.893%   99.894%   99.895%   99.896%   99.897%   99.898%   99.899% 
0.4010435 0.4019723 0.4028524 0.4037895 0.4046967 0.4056426 0.4066513 0.4075995 
  99.900%   99.901%   99.902%   99.903%   99.904%   99.905%   99.906%   99.907% 
0.4085858 0.4095375 0.4105323 0.4115539 0.4126029 0.4136008 0.4146072 0.4156925 
  99.908%   99.909%   99.910%   99.911%   99.912%   99.913%   99.914%   99.915% 
0.4167842 0.4178870 0.4190209 0.4202066 0.4214096 0.4225723 0.4237782 0.4249394 
  99.916%   99.917%   99.918%   99.919%   99.920%   99.921%   99.922%   99.923% 
0.4261180 0.4273915 0.4286506 0.4299967 0.4311933 0.4323618 0.4336237 0.4349030 
  99.924%   99.925%   99.926%   99.927%   99.928%   99.929%   99.930%   99.931% 
0.4362360 0.4376529 0.4390720 0.4404482 0.4418504 0.4432972 0.4447428 0.4461623 
  99.932%   99.933%   99.934%   99.935%   99.936%   99.937%   99.938%   99.939% 
0.4476942 0.4492497 0.4508779 0.4523965 0.4538947 0.4555093 0.4571929 0.4588788 
  99.940%   99.941%   99.942%   99.943%   99.944%   99.945%   99.946%   99.947% 
0.4607055 0.4624625 0.4641833 0.4658880 0.4676357 0.4694463 0.4713691 0.4733786 
  99.948%   99.949%   99.950%   99.951%   99.952%   99.953%   99.954%   99.955% 
0.4753347 0.4773841 0.4794486 0.4814804 0.4836171 0.4857543 0.4880043 0.4902285 
  99.956%   99.957%   99.958%   99.959%   99.960%   99.961%   99.962%   99.963% 
0.4925278 0.4948790 0.4973091 0.4997076 0.5021896 0.5047990 0.5074849 0.5102415 
  99.964%   99.965%   99.966%   99.967%   99.968%   99.969%   99.970%   99.971% 
0.5129552 0.5158361 0.5187579 0.5216463 0.5247286 0.5280174 0.5312066 0.5344724 
  99.972%   99.973%   99.974%   99.975%   99.976%   99.977%   99.978%   99.979% 
0.5380454 0.5416969 0.5454130 0.5492244 0.5530642 0.5572905 0.5615983 0.5658226 
  99.980%   99.981%   99.982%   99.983%   99.984%   99.985%   99.986%   99.987% 
0.5705172 0.5754896 0.5806410 0.5859681 0.5915360 0.5970383 0.6032801 0.6095432 
  99.988%   99.989%   99.990%   99.991%   99.992%   99.993%   99.994%   99.995% 
0.6161725 0.6234268 0.6314515 0.6404572 0.6496535 0.6603482 0.6720758 0.6857758 
  99.996%   99.997%   99.998%   99.999%  100.000% 
0.7023929 0.7234654 0.7487183 0.7864701 0.9580678

99.987% = 0.6095432
mi2p(0.6095432, 86)
p-value 1.366579e-27

gen_gen_enfermos[gen_gen_enfermos < 0.6095432] <- 0

### red final sanos

((sum(gen_gen_enfermos != 0)) + (sum(mir_gen_enfermos != 0)))/2
mir_gen_enfermos[genes, genes]<- gen_gen_enfermos
sum(mir_gen_enfermos != 0)/2
enfermos_pvalue <- mir_gen_enfermos
write.table(enfermos_pvalue, file = "enfermos_pvalue_full_adjmtx.txt", sep = "\t", col.names= NA, row.names= T, quote = F)

##### dpi
library(minet)

dim(enfermos_pvalue)
dim(sanos_pvalue)
isSymmetric(enfermos_pvalue)
isSymmetric(sanos_pvalue)
identical(rownames(enfermos_pvalue), colnames(sanos_pvalue))

sanos_pvalue_dpi <- aracne(mim =  sanos_pvalue, eps = 0.1)
enfermos_pvalue_dpi <- aracne(mim =  enfermos_pvalue, eps = 0.1)

# guardar

write.table(sanos_pvalue_dpi, file = "sanos_pvalue_dpi_adjmtx.txt", sep = "\t", col.names= NA, row.names= T, quote = F)
xmg_dpi_sanos <- graph.adjacency(adjmatrix= sanos_pvalue_dpi, mode='undirected', diag=F, weighted=T)
xsifmg_dpi_sanos <- get.data.frame(xmg_dpi_sanos)
write.table(xsifmg_dpi_sanos, file = "sanos_pvalue_dpi_sif.txt", sep = "\t", col.names= T, row.names= F, quote = F )

write.table(enfermos_pvalue_dpi, file = "enfermos_pvalue_dpi_adjmtx.txt", sep = "\t", col.names= NA, row.names= T, quote = F)
xmg_dpi_enfermos <- graph.adjacency(adjmatrix= enfermos_pvalue_dpi, mode='undirected', diag=F, weighted=T)
xsifmg_dpi_enfermos <- get.data.frame(xmg_dpi_enfermos)
write.table(xsifmg_dpi_enfermos, file = "enfermos_pvalue_dpi_sif.txt", sep = "\t", col.names= T, row.names= F, quote = F )
