RNAseq_correccion.RData

enfermos <- read.table(file = "RNAseq_86_enfermos_mi.txt", header = T, sep = '\t')
sanos <- read.table(file = "RNAseq_86_sanos_mi.txt", header = T, sep = '\t')
dim(enfermos)
dim(sanos)
length(intersect(rownames(enfermos), rownames(sanos)))
enfermos <- enfermos[intersect(rownames(enfermos), rownames(sanos)), intersect(colnames(enfermos), colnames(sanos))]
sanos <- sanos[intersect(rownames(enfermos), rownames(sanos)), intersect(colnames(enfermos), colnames(sanos))]
dim(enfermos)
dim(sanos)
identical(rownames(enfermos), rownames(sanos))
identical(colnames(enfermos), colnames(sanos))
identical(enfermos, sanos)

> dim(enfermos)
[1] 15136 15136
> dim(sanos)
[1] 15136 15136
> identical(rownames(enfermos), rownames(sanos))
[1] TRUE
> identical(colnames(enfermos), colnames(sanos))
[1] TRUE
> identical(enfermos, sanos)
[1] FALSE

enfermos <- enfermos[sort(rownames(enfermos)), sort(colnames(enfermos)) ]
sanos <- sanos[sort(rownames(sanos)), sort(colnames(sanos)) ]
colnames(enfermos) <- rownames(enfermos)
colnames(sanos) <- rownames(sanos)
enfermos <- data.matrix(enfermos)
sanos <- data.matrix(sanos)
sum(diag(enfermos))
sum(diag(sanos))
isSymmetric(enfermos)
isSymmetric(sanos)

write.table(enfermos, file = "enfermos_RNAseq.adj.txt", sep = "\t", col.names= T, row.names= T, quote = F )
write.table(sanos, file = "sanos_RNAseq.adj.txt", sep = "\t", col.names= T, row.names= T, quote = F )

e <- enfermos
s <- sanos
e[upper.tri(e, diag=T)] <- NA
s[upper.tri(s, diag=T)] <- NA
e[1:10, 1:10]
s[1:10, 1:10]
> quantile(e, na.rm=T)
       0%       25%       50%       75%      100% 
0.0000000 0.0273407 0.0387819 0.0559736 0.6657920
> quantile(s, na.rm=T)
       0%       25%       50%       75%      100% 
0.0000000 0.0411078 0.0694937 0.1256670 0.6718650 
 
> quantile(e, probs=seq(0.995, 1, 0.00001), na.rm=T)
  99.500%   99.501%   99.502%   99.503%   99.504%   99.505%   99.506%   99.507% 
0.1873390 0.1874400 0.1875370 0.1876370 0.1877340 0.1878260 0.1879210 0.1880260 
  99.508%   99.509%   99.510%   99.511%   99.512%   99.513%   99.514%   99.515% 
0.1881240 0.1882250 0.1883250 0.1884250 0.1885220 0.1886180 0.1887220 0.1888210 
  99.516%   99.517%   99.518%   99.519%   99.520%   99.521%   99.522%   99.523% 
0.1889230 0.1890260 0.1891280 0.1892340 0.1893400 0.1894390 0.1895440 0.1896460 
  99.524%   99.525%   99.526%   99.527%   99.528%   99.529%   99.530%   99.531% 
0.1897480 0.1898500 0.1899530 0.1900570 0.1901640 0.1902690 0.1903720 0.1904800 
  99.532%   99.533%   99.534%   99.535%   99.536%   99.537%   99.538%   99.539% 
0.1905840 0.1906850 0.1907900 0.1908990 0.1910090 0.1911180 0.1912210 0.1913340 
  99.540%   99.541%   99.542%   99.543%   99.544%   99.545%   99.546%   99.547% 
0.1914410 0.1915470 0.1916540 0.1917610 0.1918700 0.1919800 0.1920910 0.1922030 
  99.548%   99.549%   99.550%   99.551%   99.552%   99.553%   99.554%   99.555% 
0.1923110 0.1924210 0.1925340 0.1926470 0.1927643 0.1928760 0.1929840 0.1930930 
  99.556%   99.557%   99.558%   99.559%   99.560%   99.561%   99.562%   99.563% 
0.1932030 0.1933160 0.1934280 0.1935390 0.1936510 0.1937650 0.1938830 0.1939950 
  99.564%   99.565%   99.566%   99.567%   99.568%   99.569%   99.570%   99.571% 
0.1941140 0.1942290 0.1943470 0.1944640 0.1945800 0.1947040 0.1948200 0.1949382 
  99.572%   99.573%   99.574%   99.575%   99.576%   99.577%   99.578%   99.579% 
0.1950670 0.1951840 0.1953010 0.1954270 0.1955490 0.1956680 0.1957940 0.1959130 
  99.580%   99.581%   99.582%   99.583%   99.584%   99.585%   99.586%   99.587% 
0.1960320 0.1961560 0.1962750 0.1964010 0.1965250 0.1966480 0.1967680 0.1968970 
  99.588%   99.589%   99.590%   99.591%   99.592%   99.593%   99.594%   99.595% 
0.1970230 0.1971470 0.1972700 0.1973940 0.1975190 0.1976490 0.1977770 0.1979020 
  99.596%   99.597%   99.598%   99.599%   99.600%   99.601%   99.602%   99.603% 
0.1980330 0.1981590 0.1982890 0.1984230 0.1985533 0.1986860 0.1988200 0.1989470 
  99.604%   99.605%   99.606%   99.607%   99.608%   99.609%   99.610%   99.611% 
0.1990790 0.1992140 0.1993500 0.1994810 0.1996200 0.1997570 0.1998900 0.2000250 
  99.612%   99.613%   99.614%   99.615%   99.616%   99.617%   99.618%   99.619% 
0.2001610 0.2003017 0.2004360 0.2005670 0.2007010 0.2008384 0.2009780 0.2011132 
  99.620%   99.621%   99.622%   99.623%   99.624%   99.625%   99.626%   99.627% 
0.2012510 0.2013890 0.2015300 0.2016640 0.2018040 0.2019430 0.2020791 0.2022160 
  99.628%   99.629%   99.630%   99.631%   99.632%   99.633%   99.634%   99.635% 
0.2023560 0.2025000 0.2026450 0.2027840 0.2029240 0.2030660 0.2032050 0.2033470 
  99.636%   99.637%   99.638%   99.639%   99.640%   99.641%   99.642%   99.643% 
0.2034960 0.2036450 0.2037920 0.2039410 0.2040860 0.2042354 0.2043780 0.2045290 
  99.644%   99.645%   99.646%   99.647%   99.648%   99.649%   99.650%   99.651% 
0.2046840 0.2048320 0.2049820 0.2051220 0.2052690 0.2054200 0.2055810 0.2057400 
  99.652%   99.653%   99.654%   99.655%   99.656%   99.657%   99.658%   99.659% 
0.2058990 0.2060590 0.2062190 0.2063740 0.2065330 0.2066920 0.2068520 0.2070140 
  99.660%   99.661%   99.662%   99.663%   99.664%   99.665%   99.666%   99.667% 
0.2071820 0.2073480 0.2075150 0.2076750 0.2078400 0.2080120 0.2081760 0.2083402 
  99.668%   99.669%   99.670%   99.671%   99.672%   99.673%   99.674%   99.675% 
0.2085030 0.2086670 0.2088390 0.2090120 0.2091773 0.2093507 0.2095241 0.2096860 
  99.676%   99.677%   99.678%   99.679%   99.680%   99.681%   99.682%   99.683% 
0.2098490 0.2100194 0.2101980 0.2103660 0.2105400 0.2107080 0.2108800 0.2110570 
  99.684%   99.685%   99.686%   99.687%   99.688%   99.689%   99.690%   99.691% 
0.2112303 0.2114090 0.2115780 0.2117520 0.2119330 0.2121070 0.2122810 0.2124620 
  99.692%   99.693%   99.694%   99.695%   99.696%   99.697%   99.698%   99.699% 
0.2126440 0.2128280 0.2130150 0.2132030 0.2133850 0.2135660 0.2137550 0.2139420 
  99.700%   99.701%   99.702%   99.703%   99.704%   99.705%   99.706%   99.707% 
0.2141340 0.2143234 0.2145130 0.2147000 0.2148890 0.2150820 0.2152650 0.2154550 
  99.708%   99.709%   99.710%   99.711%   99.712%   99.713%   99.714%   99.715% 
0.2156510 0.2158497 0.2160450 0.2162405 0.2164330 0.2166240 0.2168280 0.2170340 
  99.716%   99.717%   99.718%   99.719%   99.720%   99.721%   99.722%   99.723% 
0.2172370 0.2174370 0.2176440 0.2178479 0.2180540 0.2182527 0.2184560 0.2186605 
  99.724%   99.725%   99.726%   99.727%   99.728%   99.729%   99.730%   99.731% 
0.2188680 0.2190854 0.2193000 0.2195040 0.2197150 0.2199180 0.2201290 0.2203460 
  99.732%   99.733%   99.734%   99.735%   99.736%   99.737%   99.738%   99.739% 
0.2205530 0.2207840 0.2210020 0.2212360 0.2214690 0.2216760 0.2219060 0.2221300 
  99.740%   99.741%   99.742%   99.743%   99.744%   99.745%   99.746%   99.747% 
0.2223500 0.2225840 0.2228105 0.2230580 0.2232840 0.2235130 0.2237440 0.2239760 
  99.748%   99.749%   99.750%   99.751%   99.752%   99.753%   99.754%   99.755% 
0.2242120 0.2244360 0.2246698 0.2249020 0.2251416 0.2253780 0.2256125 0.2258570 
  99.756%   99.757%   99.758%   99.759%   99.760%   99.761%   99.762%   99.763% 
0.2261060 0.2263410 0.2265880 0.2268380 0.2270890 0.2273370 0.2276028 0.2278520 
  99.764%   99.765%   99.766%   99.767%   99.768%   99.769%   99.770%   99.771% 
0.2280956 0.2283670 0.2286220 0.2288890 0.2291600 0.2294107 0.2296790 0.2299406 
  99.772%   99.773%   99.774%   99.775%   99.776%   99.777%   99.778%   99.779% 
0.2302020 0.2304654 0.2307248 0.2309882 0.2312610 0.2315350 0.2318040 0.2320820 
  99.780%   99.781%   99.782%   99.783%   99.784%   99.785%   99.786%   99.787% 
0.2323560 0.2326270 0.2329050 0.2331750 0.2334610 0.2337320 0.2340200 0.2343122 
  99.788%   99.789%   99.790%   99.791%   99.792%   99.793%   99.794%   99.795% 
0.2346070 0.2348910 0.2351750 0.2354809 0.2357783 0.2360837 0.2363820 0.2366960 
  99.796%   99.797%   99.798%   99.799%   99.800%   99.801%   99.802%   99.803% 
0.2370000 0.2373134 0.2376230 0.2379322 0.2382450 0.2385621 0.2388840 0.2391940 
  99.804%   99.805%   99.806%   99.807%   99.808%   99.809%   99.810%   99.811% 
0.2395120 0.2398277 0.2401600 0.2404820 0.2408120 0.2411370 0.2414580 0.2417850 
  99.812%   99.813%   99.814%   99.815%   99.816%   99.817%   99.818%   99.819% 
0.2421320 0.2424680 0.2427960 0.2431469 0.2434850 0.2438260 0.2441660 0.2445056 
  99.820%   99.821%   99.822%   99.823%   99.824%   99.825%   99.826%   99.827% 
0.2448630 0.2452274 0.2455810 0.2459550 0.2463056 0.2466790 0.2470310 0.2473950 
  99.828%   99.829%   99.830%   99.831%   99.832%   99.833%   99.834%   99.835% 
0.2477920 0.2481700 0.2485490 0.2489230 0.2492850 0.2496850 0.2500740 0.2504792 
  99.836%   99.837%   99.838%   99.839%   99.840%   99.841%   99.842%   99.843% 
0.2508670 0.2512560 0.2516615 0.2520819 0.2524870 0.2528880 0.2533190 0.2537610 
  99.844%   99.845%   99.846%   99.847%   99.848%   99.849%   99.850%   99.851% 
0.2541470 0.2545700 0.2549970 0.2554120 0.2558380 0.2562710 0.2567160 0.2571480 
  99.852%   99.853%   99.854%   99.855%   99.856%   99.857%   99.858%   99.859% 
0.2575580 0.2580050 0.2584490 0.2588870 0.2593570 0.2598080 0.2602588 0.2607700 
  99.860%   99.861%   99.862%   99.863%   99.864%   99.865%   99.866%   99.867% 
0.2612230 0.2616840 0.2621725 0.2626569 0.2631430 0.2636440 0.2641520 0.2646440 
  99.868%   99.869%   99.870%   99.871%   99.872%   99.873%   99.874%   99.875% 
0.2651370 0.2656444 0.2661310 0.2666820 0.2672197 0.2677591 0.2682725 0.2688110 
  99.876%   99.877%   99.878%   99.879%   99.880%   99.881%   99.882%   99.883% 
0.2693390 0.2698660 0.2704072 0.2709420 0.2714770 0.2720770 0.2726490 0.2732075 
  99.884%   99.885%   99.886%   99.887%   99.888%   99.889%   99.890%   99.891% 
0.2738137 0.2743890 0.2749615 0.2755739 0.2761850 0.2768207 0.2774620 0.2780730 
  99.892%   99.893%   99.894%   99.895%   99.896%   99.897%   99.898%   99.899% 
0.2786980 0.2793434 0.2799550 0.2806062 0.2812367 0.2818940 0.2825950 0.2832539 
  99.900%   99.901%   99.902%   99.903%   99.904%   99.905%   99.906%   99.907% 
0.2839393 0.2846007 0.2852920 0.2860020 0.2867310 0.2874244 0.2881238 0.2888780 
  99.908%   99.909%   99.910%   99.911%   99.912%   99.913%   99.914%   99.915% 
0.2896367 0.2904031 0.2911910 0.2920150 0.2928510 0.2936590 0.2944970 0.2953040 
  99.916%   99.917%   99.918%   99.919%   99.920%   99.921%   99.922%   99.923% 
0.2961230 0.2970080 0.2978830 0.2988185 0.2996500 0.3004621 0.3013390 0.3022280 
  99.924%   99.925%   99.926%   99.927%   99.928%   99.929%   99.930%   99.931% 
0.3031543 0.3041390 0.3051252 0.3060816 0.3070560 0.3080614 0.3090660 0.3100525 
  99.932%   99.933%   99.934%   99.935%   99.936%   99.937%   99.938%   99.939% 
0.3111170 0.3121980 0.3133295 0.3143848 0.3154260 0.3165480 0.3177180 0.3188896 
  99.940%   99.941%   99.942%   99.943%   99.944%   99.945%   99.946%   99.947% 
0.3201590 0.3213800 0.3225758 0.3237605 0.3249750 0.3262332 0.3275695 0.3289659 
  99.948%   99.949%   99.950%   99.951%   99.952%   99.953%   99.954%   99.955% 
0.3303253 0.3317495 0.3331842 0.3345962 0.3360810 0.3375662 0.3391298 0.3406755 
  99.956%   99.957%   99.958%   99.959%   99.960%   99.961%   99.962%   99.963% 
0.3422733 0.3439072 0.3455960 0.3472628 0.3489877 0.3508010 0.3526675 0.3545832 
  99.964%   99.965%   99.966%   99.967%   99.968%   99.969%   99.970%   99.971% 
0.3564690 0.3584710 0.3605015 0.3625087 0.3646507 0.3669362 0.3691525 0.3714220 
  99.972%   99.973%   99.974%   99.975%   99.976%   99.977%   99.978%   99.979% 
0.3739050 0.3764425 0.3790250 0.3816736 0.3843420 0.3872790 0.3902727 0.3932082 
  99.980%   99.981%   99.982%   99.983%   99.984%   99.985%   99.986%   99.987% 
0.3964707 0.3999262 0.4035060 0.4072080 0.4110773 0.4149010 0.4192387 0.4235911 
  99.988%   99.989%   99.990%   99.991%   99.992%   99.993%   99.994%   99.995% 
0.4281980 0.4332392 0.4388158 0.4450742 0.4514650 0.4588971 0.4670470 0.4765676 
  99.996%   99.997%   99.998%   99.999%  100.000% 
0.4881153 0.5027592 0.5203083 0.5465432 0.6657920

enfermos:
99.987% = 0.4235911
enfermos[enfermos < 0.4235911] <- 0
write.table(enfermos, file = "enfermos.99.87.corregido.adj.txt", sep = "\t", col.names= T, row.names= T, quote = F)

library(igraph)
eg <- graph.adjacency(adjmatrix= enfermos, mode='undirected', diag=F, weighted=T)
esif <- get.data.frame(eg)                                                                                    
write.table(esif, file = "enfermos.99.987.sif.txt", sep = "\t", col.names= T, row.names= F, quote = F )  
                                             
library(minet)  
sum(enfermos != 0)/2                                                                                           
edpi <- aracne(mim = enfermos, eps = 0.1) 
write.table(edpi, file = "enfermos.99.87.corregido.dpi.txt", sep = "\t", col.names= T, row.names= T, quote = F)
sum(edpi != 0)/2                                                                          
egdpi <- graph.adjacency(adjmatrix= edpi, mode='undirected', diag=F, weighted=T)                              
edpisif <- get.data.frame(egdpi)                                                                              
write.table(edpisif, file = "enfermos.99.987.dpi.0.1.sif.txt", sep = "\t", col.names= T, row.names= F, quote = F )    
 

edpi2 <- aracne(mim = enfermos, eps = 0.05) 
write.table(edpi2, file = "enfermos.99.87.corregido.dpi.0.05.txt", sep = "\t", col.names= T, row.names= T, quote = F)
sum(edpi2 != 0)/2                                                                          
egdpi2 <- graph.adjacency(adjmatrix= edpi2, mode='undirected', diag=F, weighted=T)                              
edpisif2 <- get.data.frame(egdpi2)                                                                              
write.table(edpisif2, file = "enfermos.99.987.dpi.0.05.sif.txt", sep = "\t", col.names= T, row.names= F, quote = F )

> quantile(s, probs=seq(0.995, 1, 0.00001), na.rm=T)
  99.500%   99.501%   99.502%   99.503%   99.504%   99.505%   99.506%   99.507% 
0.3841180 0.3842130 0.3843120 0.3844040 0.3844980 0.3845957 0.3846931 0.3847870 
  99.508%   99.509%   99.510%   99.511%   99.512%   99.513%   99.514%   99.515% 
0.3848840 0.3849780 0.3850720 0.3851690 0.3852660 0.3853630 0.3854590 0.3855530 
  99.516%   99.517%   99.518%   99.519%   99.520%   99.521%   99.522%   99.523% 
0.3856540 0.3857520 0.3858510 0.3859470 0.3860430 0.3861450 0.3862440 0.3863470 
  99.524%   99.525%   99.526%   99.527%   99.528%   99.529%   99.530%   99.531% 
0.3864450 0.3865450 0.3866440 0.3867440 0.3868390 0.3869410 0.3870460 0.3871450 
  99.532%   99.533%   99.534%   99.535%   99.536%   99.537%   99.538%   99.539% 
0.3872470 0.3873480 0.3874470 0.3875450 0.3876460 0.3877480 0.3878480 0.3879520 
  99.540%   99.541%   99.542%   99.543%   99.544%   99.545%   99.546%   99.547% 
0.3880510 0.3881500 0.3882570 0.3883600 0.3884650 0.3885690 0.3886770 0.3887760 
  99.548%   99.549%   99.550%   99.551%   99.552%   99.553%   99.554%   99.555% 
0.3888740 0.3889810 0.3890840 0.3891850 0.3892870 0.3893930 0.3894990 0.3896020 
  99.556%   99.557%   99.558%   99.559%   99.560%   99.561%   99.562%   99.563% 
0.3897050 0.3898050 0.3899070 0.3900142 0.3901170 0.3902240 0.3903320 0.3904390 
  99.564%   99.565%   99.566%   99.567%   99.568%   99.569%   99.570%   99.571% 
0.3905460 0.3906540 0.3907600 0.3908640 0.3909740 0.3910820 0.3911850 0.3912930 
  99.572%   99.573%   99.574%   99.575%   99.576%   99.577%   99.578%   99.579% 
0.3914020 0.3915070 0.3916180 0.3917240 0.3918330 0.3919420 0.3920510 0.3921610 
  99.580%   99.581%   99.582%   99.583%   99.584%   99.585%   99.586%   99.587% 
0.3922730 0.3923790 0.3924910 0.3926010 0.3927160 0.3928260 0.3929420 0.3930520 
  99.588%   99.589%   99.590%   99.591%   99.592%   99.593%   99.594%   99.595% 
0.3931720 0.3932830 0.3933970 0.3935090 0.3936219 0.3937370 0.3938470 0.3939622 
  99.596%   99.597%   99.598%   99.599%   99.600%   99.601%   99.602%   99.603% 
0.3940780 0.3941890 0.3943050 0.3944300 0.3945420 0.3946600 0.3947810 0.3949010 
  99.604%   99.605%   99.606%   99.607%   99.608%   99.609%   99.610%   99.611% 
0.3950140 0.3951270 0.3952460 0.3953600 0.3954696 0.3955850 0.3957080 0.3958270 
  99.612%   99.613%   99.614%   99.615%   99.616%   99.617%   99.618%   99.619% 
0.3959440 0.3960590 0.3961760 0.3962960 0.3964120 0.3965304 0.3966530 0.3967710 
  99.620%   99.621%   99.622%   99.623%   99.624%   99.625%   99.626%   99.627% 
0.3968840 0.3970010 0.3971200 0.3972370 0.3973580 0.3974780 0.3975940 0.3977200 
  99.628%   99.629%   99.630%   99.631%   99.632%   99.633%   99.634%   99.635% 
0.3978410 0.3979640 0.3980880 0.3982130 0.3983400 0.3984640 0.3985875 0.3987140 
  99.636%   99.637%   99.638%   99.639%   99.640%   99.641%   99.642%   99.643% 
0.3988300 0.3989537 0.3990790 0.3992050 0.3993310 0.3994580 0.3995820 0.3997140 
  99.644%   99.645%   99.646%   99.647%   99.648%   99.649%   99.650%   99.651% 
0.3998380 0.3999580 0.4000790 0.4002040 0.4003330 0.4004567 0.4005900 0.4007260 
  99.652%   99.653%   99.654%   99.655%   99.656%   99.657%   99.658%   99.659% 
0.4008560 0.4009870 0.4011150 0.4012430 0.4013740 0.4015080 0.4016360 0.4017690 
  99.660%   99.661%   99.662%   99.663%   99.664%   99.665%   99.666%   99.667% 
0.4018980 0.4020350 0.4021680 0.4023000 0.4024320 0.4025640 0.4026950 0.4028320 
  99.668%   99.669%   99.670%   99.671%   99.672%   99.673%   99.674%   99.675% 
0.4029670 0.4030990 0.4032330 0.4033580 0.4034960 0.4036320 0.4037760 0.4039170 
  99.676%   99.677%   99.678%   99.679%   99.680%   99.681%   99.682%   99.683% 
0.4040600 0.4041934 0.4043238 0.4044600 0.4045996 0.4047450 0.4048860 0.4050200 
  99.684%   99.685%   99.686%   99.687%   99.688%   99.689%   99.690%   99.691% 
0.4051530 0.4052940 0.4054330 0.4055700 0.4057090 0.4058540 0.4059950 0.4061460 
  99.692%   99.693%   99.694%   99.695%   99.696%   99.697%   99.698%   99.699% 
0.4062930 0.4064390 0.4065810 0.4067260 0.4068740 0.4070150 0.4071720 0.4073130 
  99.700%   99.701%   99.702%   99.703%   99.704%   99.705%   99.706%   99.707% 
0.4074550 0.4075950 0.4077450 0.4079000 0.4080430 0.4081900 0.4083450 0.4084920 
  99.708%   99.709%   99.710%   99.711%   99.712%   99.713%   99.714%   99.715% 
0.4086490 0.4088020 0.4089490 0.4090950 0.4092420 0.4093860 0.4095420 0.4097000 
  99.716%   99.717%   99.718%   99.719%   99.720%   99.721%   99.722%   99.723% 
0.4098606 0.4100150 0.4101755 0.4103290 0.4104830 0.4106390 0.4107921 0.4109550 
  99.724%   99.725%   99.726%   99.727%   99.728%   99.729%   99.730%   99.731% 
0.4111090 0.4112700 0.4114330 0.4115890 0.4117480 0.4119120 0.4120700 0.4122260 
  99.732%   99.733%   99.734%   99.735%   99.736%   99.737%   99.738%   99.739% 
0.4123840 0.4125357 0.4126910 0.4128550 0.4130220 0.4131860 0.4133480 0.4135080 
  99.740%   99.741%   99.742%   99.743%   99.744%   99.745%   99.746%   99.747% 
0.4136630 0.4138290 0.4139920 0.4141630 0.4143370 0.4145110 0.4146830 0.4148580 
  99.748%   99.749%   99.750%   99.751%   99.752%   99.753%   99.754%   99.755% 
0.4150260 0.4152080 0.4153768 0.4155452 0.4157220 0.4158930 0.4160660 0.4162420 
  99.756%   99.757%   99.758%   99.759%   99.760%   99.761%   99.762%   99.763% 
0.4164120 0.4165860 0.4167670 0.4169560 0.4171330 0.4173180 0.4175008 0.4176840 
  99.764%   99.765%   99.766%   99.767%   99.768%   99.769%   99.770%   99.771% 
0.4178550 0.4180350 0.4182205 0.4184040 0.4185910 0.4187710 0.4189560 0.4191470 
  99.772%   99.773%   99.774%   99.775%   99.776%   99.777%   99.778%   99.779% 
0.4193240 0.4195070 0.4196910 0.4198760 0.4200610 0.4202461 0.4204360 0.4206250 
  99.780%   99.781%   99.782%   99.783%   99.784%   99.785%   99.786%   99.787% 
0.4208130 0.4210000 0.4211930 0.4213860 0.4215740 0.4217610 0.4219530 0.4221502 
  99.788%   99.789%   99.790%   99.791%   99.792%   99.793%   99.794%   99.795% 
0.4223450 0.4225430 0.4227540 0.4229620 0.4231633 0.4233660 0.4235780 0.4237790 
  99.796%   99.797%   99.798%   99.799%   99.800%   99.801%   99.802%   99.803% 
0.4239920 0.4241900 0.4244058 0.4246190 0.4248330 0.4250340 0.4252470 0.4254610 
  99.804%   99.805%   99.806%   99.807%   99.808%   99.809%   99.810%   99.811% 
0.4256833 0.4258970 0.4261190 0.4263266 0.4265460 0.4267530 0.4269748 0.4271860 
  99.812%   99.813%   99.814%   99.815%   99.816%   99.817%   99.818%   99.819% 
0.4274126 0.4276381 0.4278590 0.4280930 0.4283130 0.4285400 0.4287780 0.4290100 
  99.820%   99.821%   99.822%   99.823%   99.824%   99.825%   99.826%   99.827% 
0.4292370 0.4294720 0.4297080 0.4299410 0.4301716 0.4304110 0.4306520 0.4308850 
  99.828%   99.829%   99.830%   99.831%   99.832%   99.833%   99.834%   99.835% 
0.4311163 0.4313530 0.4315880 0.4318280 0.4320690 0.4323030 0.4325440 0.4327970 
  99.836%   99.837%   99.838%   99.839%   99.840%   99.841%   99.842%   99.843% 
0.4330490 0.4332850 0.4335280 0.4337720 0.4340170 0.4342870 0.4345290 0.4347900 
  99.844%   99.845%   99.846%   99.847%   99.848%   99.849%   99.850%   99.851% 
0.4350480 0.4353080 0.4355648 0.4358340 0.4361000 0.4363740 0.4366400 0.4369069 
  99.852%   99.853%   99.854%   99.855%   99.856%   99.857%   99.858%   99.859% 
0.4371810 0.4374540 0.4377210 0.4379926 0.4382510 0.4385140 0.4387900 0.4390610 
  99.860%   99.861%   99.862%   99.863%   99.864%   99.865%   99.866%   99.867% 
0.4393350 0.4396320 0.4399130 0.4402040 0.4404920 0.4407950 0.4410910 0.4413790 
  99.868%   99.869%   99.870%   99.871%   99.872%   99.873%   99.874%   99.875% 
0.4416680 0.4419760 0.4422830 0.4425872 0.4429020 0.4432110 0.4435350 0.4438440 
  99.876%   99.877%   99.878%   99.879%   99.880%   99.881%   99.882%   99.883% 
0.4441610 0.4444707 0.4447802 0.4451060 0.4454450 0.4457874 0.4461080 0.4464420 
  99.884%   99.885%   99.886%   99.887%   99.888%   99.889%   99.890%   99.891% 
0.4467770 0.4471260 0.4474600 0.4477929 0.4481420 0.4484840 0.4488260 0.4491866 
  99.892%   99.893%   99.894%   99.895%   99.896%   99.897%   99.898%   99.899% 
0.4495520 0.4499220 0.4502918 0.4506680 0.4510440 0.4513891 0.4517580 0.4521370 
  99.900%   99.901%   99.902%   99.903%   99.904%   99.905%   99.906%   99.907% 
0.4525160 0.4529060 0.4533122 0.4536950 0.4540800 0.4544690 0.4548630 0.4552692 
  99.908%   99.909%   99.910%   99.911%   99.912%   99.913%   99.914%   99.915% 
0.4556800 0.4561021 0.4565015 0.4569180 0.4573383 0.4577700 0.4581950 0.4586210 
  99.916%   99.917%   99.918%   99.919%   99.920%   99.921%   99.922%   99.923% 
0.4590620 0.4594994 0.4599580 0.4604162 0.4608820 0.4613600 0.4618320 0.4623020 
  99.924%   99.925%   99.926%   99.927%   99.928%   99.929%   99.930%   99.931% 
0.4627850 0.4632570 0.4637460 0.4642620 0.4647680 0.4652824 0.4657970 0.4663050 
  99.932%   99.933%   99.934%   99.935%   99.936%   99.937%   99.938%   99.939% 
0.4668407 0.4673690 0.4678810 0.4684440 0.4690003 0.4695847 0.4701412 0.4707166 
  99.940%   99.941%   99.942%   99.943%   99.944%   99.945%   99.946%   99.947% 
0.4713080 0.4719304 0.4725020 0.4731402 0.4737937 0.4744291 0.4751030 0.4757478 
  99.948%   99.949%   99.950%   99.951%   99.952%   99.953%   99.954%   99.955% 
0.4764210 0.4770927 0.4778032 0.4784816 0.4792130 0.4799528 0.4806880 0.4814680 
  99.956%   99.957%   99.958%   99.959%   99.960%   99.961%   99.962%   99.963% 
0.4822147 0.4829830 0.4837430 0.4845689 0.4853820 0.4862787 0.4872090 0.4881020 
  99.964%   99.965%   99.966%   99.967%   99.968%   99.969%   99.970%   99.971% 
0.4890150 0.4899940 0.4909520 0.4919742 0.4929977 0.4940152 0.4950955 0.4962399 
  99.972%   99.973%   99.974%   99.975%   99.976%   99.977%   99.978%   99.979% 
0.4974080 0.4985220 0.4997702 0.5010546 0.5023140 0.5036810 0.5050938 0.5065430 
  99.980%   99.981%   99.982%   99.983%   99.984%   99.985%   99.986%   99.987% 
0.5080320 0.5096730 0.5112795 0.5131300 0.5150523 0.5170785 0.5191350 0.5213105 
  99.988%   99.989%   99.990%   99.991%   99.992%   99.993%   99.994%   99.995% 
0.5238000 0.5263988 0.5291588 0.5321140 0.5353433 0.5391153 0.5434290 0.5482517 
  99.996%   99.997%   99.998%   99.999%  100.000% 
0.5539367 0.5609487 0.5708502 0.5855100 0.6718650   

sanos
99.987% = 0.5213105
sanos[sanos < 0.5213105] <- 0

write.table(sanos, file = "sanos.99.87.corregido.adj.txt", sep = "\t", col.names= T, row.names= T, quote = F)

sg <- graph.adjacency(adjmatrix= sanos, mode='undirected', diag=F, weighted=T)
ssif <- get.data.frame(sg)                                                                                    
write.table(ssif, file = "sanos.99.987.sif.txt", sep = "\t", col.names= T, row.names= F, quote = F )

sum(sanos != 0)/2                                                                                           
sdpi <- aracne(mim = sanos, eps = 0.1) 
sum(sdpi != 0)/2                       
write.table(sdpi, file = "sanos.99.87.corregido.dpi.txt", sep = "\t", col.names= T, row.names= T, quote = F)                                                 
sgdpi <- graph.adjacency(adjmatrix= sdpi, mode='undirected', diag=F, weighted=T)                              
sdpisif <- get.data.frame(sgdpi)                                                                              
write.table(sdpisif, file = "sanos.99.987.dpi.0.1.sif.txt", sep = "\t", col.names= T, row.names= F, quote = F )

sum(sanos != 0)/2                                                                                           
sdpi2 <- aracne(mim = sanos, eps = 0.05) 
sum(sdpi2 != 0)/2                       
write.table(sdpi2, file = "sanos.99.87.corregido.dpi.0.05.txt", sep = "\t", col.names= T, row.names= T, quote = F)                                                 
sgdpi2 <- graph.adjacency(adjmatrix= sdpi2, mode='undirected', diag=F, weighted=T)                              
sdpisif2 <- get.data.frame(sgdpi2)                                                                              
write.table(sdpisif2, file = "sanos.99.987.dpi.0.05.sif.txt", sep = "\t", col.names= T, row.names= F, quote = F )




library(ggplot2)
library(reshape2)
enfermos1 <- read.table("enfermos.86.txt", sep="\t", header=T, row.names=1)
sanos1 <- read.table("sanos.86.txt", sep="\t", header=T, row.names=1)
enfermos1 <- enfermos1[intersect(rownames(enfermos1), rownames(sanos1)), ]
sanos1 <- sanos1[intersect(rownames(enfermos1), rownames(sanos1)), ]
identical(rownames(enfermos1), rownames(sanos1))
identical(gsub('.{3}$', '',colnames(enfermos1)), gsub('.{3}$', '',colnames(sanos1)))
RNA <- cbind(enfermos1,sanos1)
RNA752 <- read.table("RNAseq_752_norm.rsem.aracne.txt", sep="\t", header=T, row.names=1)

densityplot <- function(g){
  M1 <- log10(g+1)
  M2 <- cbind(rownames(M1), M1)
  rownames(M2) <- NULL
  colnames(M2)[1] <- "ID"
  l2 = melt(M2)
  l2
}

densityplot2 <- function(g){
  M1 <- log2(g+1)
  M2 <- cbind(rownames(M1), M1)
  rownames(M2) <- NULL
  colnames(M2)[1] <- "ID"
  l2 = melt(M2)
  l2
}

e <- densityplot(enfermos1)
e2 <- densityplot2(enfermos1)
s <- densityplot(sanos1)
s2 <- densityplot2(sanos1)
r <- densityplot(RNA)
r2 <- densityplot2(RNA)
R <- densityplot(RNA752)
R2 <- densityplot2(RNA752)

pdf("enfermos.corregido.RNAseq.86.pdf",width=10,height=10)
ggplot(na.omit(e), aes(value)) + geom_density(aes(group = variable))
dev.off()
pdf("sanos.corregido.RNAseq.86.pdf",width=10,height=10)
ggplot(na.omit(s), aes(value)) + geom_density(aes(group = variable))
dev.off()
pdf("corregido.RNAseq.86.pdf",width=10,height=10)
ggplot(na.omit(r), aes(value)) + geom_density(aes(group = variable))
dev.off()
pdf("corregido.RNAseq.752.pdf",width=10,height=10)
ggplot(na.omit(R), aes(value)) + geom_density(aes(group = variable))
dev.off()
pdf("enfermos.corregido.log2.RNAseq.86.pdf",width=10,height=10)
ggplot(na.omit(e2), aes(value)) + geom_density(aes(group = variable))
dev.off()
pdf("sanos.corregido.log2.RNAseq.86.pdf",width=10,height=10)
ggplot(na.omit(s2), aes(value)) + geom_density(aes(group = variable))
dev.off()
pdf("corregido.log2.RNAseq.86.pdf",width=10,height=10)
ggplot(na.omit(r2), aes(value)) + geom_density(aes(group = variable))
dev.off()
pdf("corregido.log2.RNAseq.752.pdf",width=10,height=10)
ggplot(na.omit(R2), aes(value)) + geom_density(aes(group = variable))
dev.off()





