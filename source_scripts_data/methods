\section*{Methods} 

\begin{figure}[H]
\begin{center}
\includegraphics[height=16cm]{diagrama1.pdf}
\caption{Methodology diagram \textcolor{red}{agregar en figura los 4 datos por ppacientes}.}
\end{center}
\label{diagrama}
\end{figure}


Level 3 data from 86 breast invasive carcinoma (BCRA) patients were obtained from TCGA. \textcolor{red}{esta fea} For each patient we obtained the RNA sequencing (RNAseq) and miRNA sequencing (miRNAseq) data from the platforms: Illumina HiSeq 2000 RNA Sequencing Version 2 analysis, and Illumina HiSeq 2000 miRNA Sequencing, respectively. In order to control the variablity in the comparisons between controls and cases we decided to only select patients with adjacent tissue controls matched to the primary solid tumor, with both RNAseq and miRNAseq matched data for the tumor and the control samples.\\

\subsection*{MiRNA data pre-processing }
We calculated the mature miRNA counts according to the methodology recommended in the BCGSC (Canada's Michael Smith Genome Sciences Centre) miRNA Profiling Pipeline Documentation (\url{https://github.com/bcgsc/mirna}) according to the miRBase release v.21 (\cite{Kozomara2014}, \cite{Griffiths-Jones2008}, \cite{Griffiths-Jones2006}) with the TCGA miRNA isoform information. Once mature counts were calculated, miRNAs with 5 counts in less than 25\% of the samples were filtered from the analysis (\cite{Tam2015}) and the remaining sets were normalized by the 'Trimmed mean of M normalization' (TMM) (\cite{Robinson2010}) contained in the EdgeR (v.3.12.0) R package (\cite{Robinson2010a}).\\

\subsection*{RNAseq data pre-processing}   
The V2 analysis of the RNAseq platform TCGA consists in the ``RNA-Seq by Expectation-Maximization'' (RSEM) normalization (\cite{Li2010}, \cite{Li2011}). Upper quartile normalized RSEM gene count estimates (transcripts per million (TPM) were used for the analysis, and filtered for RNAs with less than 10 TPM per sample (in average). \\

From RNAseq and miRNAseq normalized datasets we constructed expression matrices that were joint together matching for TCGA patient code for its further analysis (Figure 1, section 3). This joint expression matrix was used as input for network construction.\\

\subsection*{Network construction }
For a given phenotype, genes that exhibit a similar transcriptional response are likely to be part of a common biological process. Reverse engineering gene networks represent transcripts regulatory interactions topology as a graph (Gene Regulatory Networks (GRN)) (\cite{Bansal2007}). ARACNE (Algorithm for the Reconstruction of Accurate Cellular Networks) (\cite{Margolin2006}, \cite{Basso2005}) is a widely used information-theoretic algorithm that accounts for genes as nodes, and interactions (edges) as the statistical dependency between gene expression profiles, correlating pairs of genes by means of Mutual Information (MI).  MI values are directly related to the degree of statistical dependency between pairs of genes, thus the direction of the interactions can not be inferred only from this methodology. It is worth to mention that the differences in the dynamic range between miRNA and gene datasets is not an impediment for the analysis, since the datasets are adequately normalized.\\

A parallelized implementation of the ARACNE2 algorithm (\cite{Tovar2015}) and the MINET (v.3.28.0) R package (\cite{Meyer2008}) were used for the MI network construction.\\

A critical step in the network construction is the selection of variables (genes, miRNAs) that are more representative of the phenomenon (feature selection). For MI-based networks there is a relationship between MI value, number of samples and the network statistical significance (\cite{Margolin2006a}). Considering the main objective of this work is to understand the role of miRNA regulation in breast cancer, we decided to preponderate the miRNA-miRNA and miRNA-gene interactions over the gene-gene ones. From the miRNA-gene expression matrix a MI-based undirected network was generated. For the interaction pruning we used a MI value cutoff associated with the filtering of the 99.987\% of the gene-gene interactions ($p-value = 1.233311e^{-23}$ for controls and $p-value = 2.963435e^{-19}$ for cases), and the 99.980\% of the miRNA-miRNA and miRNA-gene interactions ($p-value = 4.455989e^{-13}$ for controls and $p-value = 6.357785 e^{-07}$ for cases). These cutoffs, together with a data processing inequality (DPI) threshold of 0.1 were chosen to assess for a representative fraction of the strongest relationships. Both networks were analyzed separately because we observed that miRNA associated MI values are characterized by different dynamic ranges to the values observed for the gene-gene interactions. For more information regarding the network inference methodology please refer to \textcolor{red}{Supplemental Experimental Procedures.} \\

As mentioned before, interactions in the network represent statistical dependence between pairs of expression profiles, this property is particularly useful to reconstruct the canonical and non-canonical co-expression relationships between miRNAs and genes without having to imply linearity between interactions or applying \textit{a priori} biological criteria (e.g. Pearson correlation between miRNAs and targets), specially since most interactions and their nature are widely unknown. To follow this methodology acquires crucial relevance in the case of miRNAs interactions because their overall functionality remain to be discovered. \\

\subsection*{Network analysis}
To study the networks topological properties the network analyzer Cytoscape (v.3.2.1) (\cite{Shannon2003}) plug-in was used.  The analysis focused in the degree  centrality measures, stressing on the most connected miRNAs and their first neighbors (nodes directly connected). The same Cytoscape version was used to generate the networks visualizations. \\

\subsubsection*{Differential expression analysis}  
The differential expression analysis of RNAseq gene results and mature miRNA raw counts was performed by using the DESeq2 (v.1.10.1) R package (\cite{Love2014}).\\

The network construction pipeline can be found at the 'GitHub' repository hosting service (\url{https://github.com/CSB-IG/miRNAseq_rnw}). Analyses were mainly conducted in R programming language (v.3.2.0) (\cite{RCT2015}).\\

----------------

Level 3 RNA sequencing (RNAseq) (Illumina HiSeq 2000 RNA Sequencing Version 2 analysis) and miRNA sequencing (miRNAseq) (Illumina HiSeq 2000 miRNA Sequencing) from 86 primary BCRA patients was obtained from TCGA (Figure 1, section 1). In order to control the variability in the comparisons between controls and cases we decided to only select patients with adjacent tissue controls matched to the tumour, with RNAseq and miRNAseq data for both samples.\\

\subsection*{MiRNA data pre-processing }
We calculated the mature miRNA counts according to the methodology recommended in the BCGSC miRNA Profiling Pipeline Documentation (\cite{Chu13082015}) according to the miRBase release v.21 (\cite{Kozomara2014}, \cite{Griffiths-Jones2008}, \cite{Griffiths-Jones2006}) with the TCGA miRNA isoform information. Once mature counts were calculated, miRNAs with less than 5 counts in the 25\% of the samples were filtered from the analysis (\cite{Tam2015}) and the remaining sets were normalized by the 'Trimmed mean of M normalization' (TMM) (\cite{Robinson2010}) contained in the EdgeR (v.3.12.0) R package (\cite{Robinson2010a}) (Figure 1, section 2).\\

\subsection*{RNAseq data pre-processing}   
The Version 2 analysis of the TCGA RNAseq Illumina platform consists in the ``RNA-Seq by Expectation-Maximization'' (RSEM) normalization (\cite{Li2010}, \cite{Li2011}). Upper quartile normalized RSEM gene count estimates (transcripts per million (TPM) were used for the analysis, and filtered for RNAs with less than 10 TPM per sample (in average). \\

From RNAseq and miRNAseq normalized datasets we constructed expression matrices that were joint together matching for TCGA patient code for its further analysis (Figure 1, section 3). This joint expression matrix was used as input for network construction.\\

\subsection*{Network construction }
For a given phenotype, genes that exhibit a similar transcriptional response are likely to be part of a common biological process. Reverse engineering gene networks represent transcripts regulatory interactions topology as a graph (Gene Regulatory Networks) (\cite{Bansal2007}). ARACNE (Algorithm for the Reconstruction of Accurate Cellular Networks) (\cite{Margolin2006}, \cite{Basso2005}) is a widely used information-theoretic algorithm that accounts for genes as nodes, and interactions (edges) as the statistical dependency between gene expression profiles, correlating pairs of genes by means of Mutual Information (MI).  MI values are directly related to the degree of statistical dependency between pairs of genes, thus the direction of the interactions can not be inferred only from this methodology. It is worth to mention that the differences in the dynamic range between miRNA and gene datasets is not an impediment for the analysis, since the datasets are adequately normalized.\\

A parallelized implementation of the ARACNE2 algorithm (\cite{Tovar2015}) and the MINET (v.3.28.0) R package (\cite{Meyer2008}) were used to construct the network by computing the MI between all the genes and miRNAs in the dataset and the application of the the data processing inequality (DPI) to maintain the most significant interactions for each triplet a tolerance threshold value of 0.1 was used (Figure 1, section 4), as recommended in \cite{Margolin2006}.\\

A critical step in the network construction is the selection of variables ($g$, $\mu$) that are more representative of the phenomenon (feature selection). For MI-based networks there is a relationship between MI value, number of samples and the network statistical significance (\cite{Margolin2006a}). We decided to prioritize the $\mu$-$\mu$ and $\mu$-$g$ interactions over the $g$-$g$ ones by applying a slightly less astringent cut-off value over the $\mu$ interactions. From the $\mu$-$g$ expression matrix a MI-based undirected network was generated. For the interaction pruning we used a MI value cut-off associated with the filtering of the 99.987\% of the $g$-$g$ interactions ($p-value = 6.215066e^{-34}$ for controls and $p-value = 1.366579e^{-27}$ for cases), and the 99.741\% of the $\mu$-$\mu$ and $g$-$\mu$ interactions ($p-value = 1.145633e^{-18}$ for controls and $p-value = 8.404019e^{-10}$ for cases). The selected cut-off values together with a data processing inequality (DPI) threshold of 0.1 were chosen to assess for a representative fraction of the strongest relationships.\\
%Both networks were analysed separately because we observed that $\mu$ associated MI values are characterized by different dynamic ranges than the values observed for the $g$-$g$ interactions. For more information regarding the network inference methodology please refer to \textcolor{red}{Supplemental Experimental Procedures.} \\

As mentioned before, interactions in the network represent statistical dependence between pairs of expression profiles, this property is particularly useful to reconstruct the canonical and non-canonical co-expression relationships between $\mu$ and $g$ without having to assume linear behaviour for their interactions (e.g. Pearson correlation between $\mu$ and targets) or applying \textit{a priori} biological criteria, specially since most interactions and their nature are widely unknown. To follow this methodology acquires crucial relevance in the case of $\mu$ interactions because their overall functionality remain to be discovered. \\

\subsection*{Network analysis}
To study the networks topological properties the network analyser Cytoscape (v.3.2.1) (\cite{Shannon2003}) plug-in was used.  The analysis focused in the degree  centrality measures, stressing on the most connected $\mu$ and their first neighbours (nodes directly connected). The same Cytoscape version was used to generate the networks visualizations. \\

\subsubsection*{Differential expression analysis}  
The differential expression analysis of RNASeq gene results and mature miRNASeq raw counts was performed by using the DESeq2 (v.1.10.1) R package (\cite{Love2014}). The differential expressed genes were used to identify important nodes with a possible relevant biological role. The network construction pipeline can be found at the GitHub repository hosting service (\url{https://github.com/CSB-IG/miRNAseq_rnw}). Analyses were mainly conducted in R programming language (v.3.2.0).\\

\subsection*{Functional analysis}
To study the biological significance of the networks structure and properties, a functional enrichment analysis was performed. For the networks gene component we used the BiNGO Cytoscape plug-in ((Figure 1, section 5)); this tool gives relevant information regarding the ontologies of the biological processes, molecular functions and cellular components regarding gene collections. The statistical significance of the association depends on a hypergeometric test from the input gene collection and the database collections, using information from both to calculate the probability of certain genes to pertain to a specific process.\\

For the $\mu$ functional enrichment we resort to a literature search for the $\mu$ biological relationships, since there are few integrative tools available to analyse them. In order to study the $\mu$ that might have a stronger biological relevance for the phenotype we only selected the $\mu$ from the most connected $\mu_{f}$ in the networks and their first neighbours to be enriched.\\


--------------



